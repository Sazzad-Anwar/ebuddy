(this["webpackJsonpmern-pwa-project-template"]=this["webpackJsonpmern-pwa-project-template"]||[]).push([[0],{209:function(e){e.exports=JSON.parse('{"a":""}')},540:function(e,t,a){},541:function(e,t,a){},542:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(12),c=a.n(s),r=a(57),i=a(93),o=a(78),l=a(21),j=a(17),d=a.n(j),u=a(100),m=a(35),h=a(19),b=a(572),p=a(573),x=a(290),f=a(586),O=a(578),g=a(588),v=a(587),w=a(40),y=a.n(w),N=a(591),_=a(576),k=a(577),C=a(589),S=a(72),L=a.n(S),U=a(157),D=a.n(U),I="USER_LOGIN_REQUEST",E="USER_LOGIN_SUCCESS",R="USER_LOGIN_FAILED",A="USER_LOGOUT",F="USER_UPDATE_SUCCESS",P="USER_UPDATE_FAILED",T=a(2),M=function(){var e,t=Object(i.useToasts)().addToast,a=Object(r.c)((function(e){return e.userLogin})).user,s=Object(l.g)(),c=Object(r.b)(),o=Object(n.useState)(""),j=Object(h.a)(o,2),w=j[0],S=j[1],U=Object(n.useState)(""),A=Object(h.a)(U,2),F=A[0],P=A[1],M=Object(n.useState)([]),z=Object(h.a)(M,2),B=z[0],W=z[1],G=Object(n.useState)(!1),H=Object(h.a)(G,2),J=H[0],Y=H[1],K=Object(n.useRef)(0),Q=function(){var e=Object(m.a)(d.a.mark((function e(t){var a,n,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.target.files,n=new FormData,s=0;s<a.length;s++)n.append("uploads",a[s]);return e.prev=3,e.next=6,y.a.post("/api/v1/upload",n);case 6:c=e.sent,c.data.map((function(e){return W((function(t){return[].concat(Object(u.a)(t),[e.filePath])}))})),Y(!0),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.log(e.t0.response);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split("/uploads/")[1],console.log({id:t,uploadId:a}),e.next=4,y.a.delete("/api/v1/upload/".concat(a));case 4:W(B.filter((function(e){return e!==t}))),Y(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){a&&(null===a||void 0===a?void 0:a.isLoggedIn)&&s.push("/chat")}),[s,c,a]);var q=function(){var e=Object(m.a)(d.a.mark((function e(){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!F||J){e.next=9;break}return e.next=4,y.a.get("/api/v1/user?email=".concat(F));case 4:a=e.sent,(n=a.data).isSuccess&&W([n.user.photo]),e.next=10;break;case 9:F?F&&J&&W([]):(t("Email can not be null",{autoDismiss:!0,appearance:"error"}),Y(!1));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return Object(T.jsxs)("div",{className:"bg-primary login__screen",children:[Object(T.jsxs)(b.a,{className:"",children:[Object(T.jsx)("h3",{className:"text-white pt-5 text-center",children:"e-chat-Buddy"}),Object(T.jsxs)(p.a,{children:[Object(T.jsx)(x.a,{lg:4}),Object(T.jsx)(x.a,{xs:12,md:12,lg:4,children:Object(T.jsxs)(f.a,{onSubmit:function(e){if(e.preventDefault(),w&&F){var a={name:w,email:F,photo:B[0]};c(function(e){return function(){var t=Object(m.a)(d.a.mark((function t(a){var n,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:I}),t.next=4,y.a.post("/api/v1/user",e);case 4:n=t.sent,s=n.data,console.log(s),localStorage.setItem("user",JSON.stringify(s.user)),a({type:E,payload:s.user}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),a({type:R,payload:t.t0.response?t.t0.response:t.t0.message});case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()}(a)),s.push("/chat")}else t("Name or Email can not be null",{autoDismiss:!0,appearance:"error"})},className:"my-5",children:[Object(T.jsxs)("div",{className:"d-flex justify-content-center align-items-center position-relative photo",children:[Object(T.jsx)(N.a,{alt:w,src:null!==(e=B[0])&&void 0!==e?e:"/logo.gif",style:{height:150,width:150},className:"shadow-lg border border-dark"}),B[0]&&Object(T.jsx)(_.a,{className:"position-absolute delete__icon",onClick:function(){return $(B[0])},children:Object(T.jsx)(L.a,{className:"text-white"})})]}),Object(T.jsxs)(f.a.Group,{className:"mb-3",controlId:"name",children:[Object(T.jsx)(f.a.Label,{className:"text-white",children:"User Name"}),Object(T.jsx)(f.a.Control,{value:w,onChange:function(e){return S(e.target.value)},type:"text",placeholder:"Enter Name",htmlFor:"name"})]}),Object(T.jsxs)(f.a.Group,{className:"mb-3",controlId:"email",children:[Object(T.jsx)(f.a.Label,{className:"text-white",children:"Email address"}),Object(T.jsx)(f.a.Control,{value:F,onChange:function(e){return P(e.target.value)},type:"email",placeholder:"Enter email",htmlFor:"email"})]}),Object(T.jsx)(k.a,{control:Object(T.jsx)(C.a,{checked:J,onChange:function(){Y(!J),q()},className:"text-white"}),label:"Photo is Uploaded",className:"text-white"}),!J&&Object(T.jsxs)(f.a.Group,{className:"mb-3",controlId:"photo",children:[Object(T.jsx)(f.a.Label,{className:"text-white",children:"Upload Your Photo"}),Object(T.jsx)("div",{className:"input-group mb-3",children:Object(T.jsx)("input",{type:"file",className:"form-control",accept:"image/*",onChange:Q,placeholder:"Input Photos",id:"inputGroupFile02"})})]}),Object(T.jsx)(O.a,{variant:"outline-secondary w-100",type:"submit",children:"Login"})]})}),Object(T.jsx)(x.a,{lg:4})]})]}),Object(T.jsx)(g.a,{className:"nav__bar fixed-bottom",ref:K,expand:"lg",children:Object(T.jsxs)(b.a,{className:"d-flex flex-column",children:[Object(T.jsxs)(v.a,{className:" align-items-center py-2 text-white",children:["Copyright ",Object(T.jsx)(D.a,{className:"me-2"})," ",(new Date).getFullYear()," ","e-Chat-Buddy. All rights reserved."]}),Object(T.jsx)(v.a,{className:"align-items-center pb-4 text-white",children:"Designed & Developed By Sazzad Bin Anwar"})]})})]})},z=function(){return Object(T.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},children:Object(T.jsx)("h4",{children:"404 | Page Not Found"})})},B=a(213),W=a(319),G=function(e){var t=e.children,a=Object(W.a)(e,["children"]),n=Object(r.c)((function(e){return e.userLogin})).user;return Object(T.jsx)(l.b,Object(B.a)(Object(B.a)({},a),{},{render:function(e){var a=e.location;return n&&n.isLoggedIn?t:Object(T.jsx)(l.a,{to:{pathname:"/",state:{from:a}}})}}))},H=a(544),J=function(){return Object(T.jsx)(T.Fragment,{children:Object(T.jsx)(H.a,{component:"h1",variant:"h4",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"},children:"This is login page"})})},Y=a(583),K=a(291),Q=a(584),$=a(313),q=a.n($),V=a(585),X=a(592),Z=a(581),ee=a(582),te=a(590),ae=a(83),ne=a.n(ae),se=a(295),ce=a(318),re=a(312),ie=a.n(re),oe=a(212),le=a.n(oe),je=a(315),de=a.n(je),ue=a(99),me=a.n(ue),he=a(311),be=a.n(he),pe=a(314),xe=a.n(pe),fe=a(579),Oe=a(207),ge=a(211),ve=a.n(ge),we=a(199),ye=a.n(we),Ne=a(309),_e=a.n(Ne),ke=a(119),Ce=a.n(ke),Se=a(308),Le=a.n(Se),Ue=a(11),De=a.n(Ue),Ie=a(210),Ee=a.n(Ie),Re=a(208),Ae=a.n(Re),Fe=a(95),Pe=a.n(Fe),Te=a(209),Me=function(e){var t=e.fileData,a=e.setShow,n=e.setChatImage;return".png"===De.a.extname(t)||".jpg"===De.a.extname(t)||".jpeg"===De.a.extname(t)||".gif"===De.a.extname(t)?Object(T.jsx)(x.a,{xs:12,md:4,className:"g-2",children:Object(T.jsxs)(fe.a,{elevation:5,className:"mb-0 img__card",style:{cursor:"pointer",position:"relative",height:200,width:200},children:[Object(T.jsx)("img",{src:t,height:200,width:200,className:"position-absolute",alt:"upload-".concat(t),style:{right:0,top:0,bottom:0,left:0}}),Object(T.jsx)("div",{className:"position-absolute start-0 top-0 end-0 bottom-0 download__btn",children:Object(T.jsx)(Ee.a,{className:"bg-white rounded-circle position-absolute",style:{top:"50%",left:"50%",transform:"translate(-50%,-50%)",cursor:"pointer",zIndex:1},onClick:function(){return Ae.a.saveAs("".concat(Te.a).concat(t),"image.".concat(De.a.extname(t)))}})}),Object(T.jsx)("div",{className:"position-absolute start-0 top-0 end-0 bottom-0 download__btn",children:Object(T.jsx)(Le.a,{className:"bg-white rounded-circle position-absolute",style:{top:0,right:0,cursor:"pointer"},onClick:function(){a(!0),n(t)}})})]})},t):".mp4"===De.a.extname(t)||".mov"===De.a.extname(t)||".wmv"===De.a.extname(t)||".flv"===De.a.extname(t)||".webm"===De.a.extname(t)||".mkv"===De.a.extname(t)?Object(T.jsx)(x.a,{xs:12,className:"g-2",children:Object(T.jsx)(fe.a,{elevation:5,className:"mb-0 img__card",style:{cursor:"pointer",position:"relative",height:400,width:400},children:Object(T.jsx)("video",{controls:!0,width:"100%",height:"400",children:Object(T.jsx)("source",{src:t,type:"video/".concat(De.a.extname(t).split(".")[1])})})})},t):".mp3"===De.a.extname(t)||".ogg"===De.a.extname(t)||".mpeg"===De.a.extname(t)?Object(T.jsx)(x.a,{xs:12,className:"g-2",children:Object(T.jsx)("audio",{controls:!0,children:Object(T.jsx)("source",{src:t,type:"audio/".concat(De.a.extname(t).split(".")[1])})})},t):Object(T.jsx)(x.a,{xs:12,className:"g-2",children:Object(T.jsx)(fe.a,{elevation:5,className:"mb-0 py-1 px-2 rounded",style:{backgroundColor:"#616161"},children:Object(T.jsxs)("div",{className:"d-flex justify-content-between align-items-center",style:{width:200},children:[Object(T.jsx)(Pe.a,{className:"text-white"}),Object(T.jsx)("span",{className:"col-4 text-truncate text-white",children:t.split("/")[2]}),Object(T.jsx)("span",{className:"text-white",children:De.a.extname(t)}),Object(T.jsx)(_.a,{children:Object(T.jsx)(Ee.a,{className:"text-white",onClick:function(){return Ae.a.saveAs("".concat(Te.a).concat(t),"file.".concat(De.a.extname(t)))}})})]})})},t)},ze=function(e){var t=e.messageDetails,a=e.user,s=e.roomUser,c=e.editMsg,r=e.deleteMsg,i=e.replyMsg,o=Object(n.useState)(!1),l=Object(h.a)(o,2),j=l[0],d=l[1],u=Object(n.useState)(null),m=Object(h.a)(u,2),b=m[0],x=m[1],f=Object(n.useState)(""),O=Object(h.a)(f,2),g=O[0],v=O[1],w=Boolean(b),y=function(e){x(e.currentTarget)},k=function(){x(null)};return a.email!==t.from&&s.email===t.from&&a.email===t.to?Object(T.jsxs)("div",{className:"d-flex my-3 chat__buddy",style:{marginRight:"20%"},children:[Object(T.jsx)(N.a,{alt:s.name,src:s.photo,style:{width:32,height:32}}),Object(T.jsxs)("div",{className:"d-flex flex-column align-items-start",children:[Object(T.jsxs)("div",{className:"d-flex",children:[t.message&&Object(T.jsxs)("div",{className:"chat__card chat__person ms-0 p-2",children:[t.repliedOf&&Object(T.jsx)(fe.a,{body:!0,className:"chat__card chat__person p-2 chat__reply text-white col-4 text-truncate rounded-top",style:{width:"100%"},children:Object(T.jsxs)("i",{children:[t.repliedOf," ",Object(T.jsx)(Ce.a,{})]})}),Object(T.jsx)(fe.a,{body:!0,className:"chat__card chat__person p-2",style:{width:"100%"},children:t.message.startsWith("http")?Object(T.jsx)(Oe.ReactTinyLink,{cardSize:"small",showGraphic:!0,maxLine:2,minLine:1,proxyUrl:"https://corsanywhere.herokuapp.com",url:t.message}):t.message})]}),Object(T.jsx)(_.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:y,className:"ms-2",children:Object(T.jsx)(ve.a,{})}),Object(T.jsx)(V.a,{id:"long-menu",anchorEl:b,keepMounted:!0,open:w,onClose:k,PaperProps:{style:{maxHeight:216}},children:Object(T.jsx)(X.a,{onClick:function(){k(),i(t._id)},children:Object(T.jsx)(Ce.a,{})})})]}),t.file&&Object(T.jsx)(p.a,{className:"ms-2",children:t.file.map((function(e){return Object(T.jsx)(Me,{fileData:e,setShow:d,setChatImage:v})}))}),Object(T.jsx)("p",{className:"text-white ms-2 mt-1 last__seen",children:ne()(t.updatedAt).fromNow()})]})]}):a.email===t.from&&s.email===t.to?Object(T.jsxs)("div",{className:"d-flex flex-column justify-content-end align-items-end my-3",style:{marginLeft:"20%"},children:[Object(T.jsxs)("div",{className:"d-flex my__chat text-right justify-content-end",children:[Object(T.jsxs)("div",{className:"chat__card me-3 d-flex justify-content-center align-items-center",children:[Object(T.jsx)(_.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:y,className:"me-3",children:Object(T.jsx)(ve.a,{})}),Object(T.jsxs)(V.a,{id:"long-menu",anchorEl:b,keepMounted:!0,open:w,onClose:k,PaperProps:{style:{maxHeight:216}},children:[Object(T.jsx)(X.a,{onClick:function(){k(),r(t._id)},children:Object(T.jsx)(ye.a,{})}),t.message&&Object(T.jsx)(X.a,{onClick:function(){k(),c(t._id)},children:Object(T.jsx)(_e.a,{})}),Object(T.jsx)(X.a,{onClick:function(){k(),i(t._id)},children:Object(T.jsx)(Ce.a,{})})]}),Object(T.jsxs)("div",{className:"d-flex flex-column justify-content-end align-items-center",children:[t.message&&Object(T.jsxs)("div",{className:"chat__person p-2",children:[t.repliedOf&&Object(T.jsx)(fe.a,{body:!0,className:"chat__person p-2 chat__reply text-white col-4 text-truncate",style:{width:"100%"},children:Object(T.jsxs)("i",{children:[t.repliedOf," ",Object(T.jsx)(Ce.a,{})]})}),Object(T.jsx)(fe.a,{body:!0,className:"chat__person p-2",style:{width:"100%"},children:t.message.startsWith("http")?Object(T.jsx)(Oe.ReactTinyLink,{cardSize:"small",showGraphic:!0,maxLine:2,minLine:1,proxyUrl:"https://corsanywhere.herokuapp.com",url:t.message}):t.message})]}),t.file&&Object(T.jsx)(p.a,{children:t.file.map((function(e){return Object(T.jsx)(Me,{fileData:e,setShow:d,setChatImage:v})}))})]})]}),Object(T.jsx)(N.a,{alt:a.name,src:a.photo,style:{width:32,height:32,marginRight:10}})]}),Object(T.jsx)("p",{className:"text-white mt-1 me-3 pe-5 last__seen",children:ne()(t.updatedAt).fromNow()}),Object(T.jsxs)(Q.a,{show:j,onHide:function(){return d(!j)},fullscreen:"md-down",centered:!0,className:"shadow-lg w-100",children:[Object(T.jsx)("img",{alt:g,src:g}),Object(T.jsx)(me.a,{className:"bg-white rounded-circle position-absolute",style:{top:"-10px",right:"-10px",cursor:"pointer"},onClick:function(){return d(!j)}})]})]}):(s.email,t.to,null)},Be=a(580),We=function(e){var t=e.userInfo,a=e.messages,n=e.findRoomUser,s=e.setReplyMsgDetails,c=e.setDisplayMessages,r=e.showMobileChat;return Object(T.jsxs)(fe.a,{elevation:10,body:!0,className:t.isActive?"bg-success p-2 d-flex align-items-center mb-3":"bg-dark p-2 d-flex align-items-center mb-3",style:{cursor:"pointer"},onClick:function(){n(t.email),s(""),c(!!r)},children:[Object(T.jsx)(Be.a,{badgeContent:t.isActive?a.filter((function(e){return e.from===t.email})).length:0,color:"primary",children:Object(T.jsx)(N.a,{alt:t.name,src:t.photo,className:"shadow-lg border"})}),Object(T.jsxs)("div",{className:"ps-3 ",children:[Object(T.jsx)("p",{className:"text-white my-0 fs-6 user__name_list",children:t.name}),Object(T.jsx)("p",{className:"text-white my-0 last__seen",children:t.isActive?"Online":"Active ".concat(ne()(t.updatedAt).fromNow())})]})]})},Ge=function(e){var t=e.fileData,a=e.removeFile,s=Object(n.useRef)(0);return".png"===De.a.extname(t)||".jpg"===De.a.extname(t)||".jpeg"===De.a.extname(t)||".gif"===De.a.extname(t)?Object(T.jsx)(x.a,{xs:12,md:6,className:"g-2",children:Object(T.jsxs)(fe.a,{elevation:5,className:"mb-0 img__card",style:{position:"relative",height:200,width:200},children:[Object(T.jsx)("img",{src:t,height:200,width:200,className:"position-absolute",alt:"upload-".concat(t),style:{right:0,top:0,bottom:0,left:0}}),Object(T.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer"},onClick:function(){return a(t)}})]})},t):".mp4"===De.a.extname(t)||".mov"===De.a.extname(t)||".wmv"===De.a.extname(t)||".flv"===De.a.extname(t)||".webm"===De.a.extname(t)||".mkv"===De.a.extname(t)?Object(T.jsx)(x.a,{xs:12,className:"g-2",children:Object(T.jsxs)(fe.a,{elevation:5,className:"mb-0 img__card",style:{position:"relative"},children:[Object(T.jsx)("video",{controls:!0,width:"100%",height:"400",children:Object(T.jsx)("source",{src:t,type:"video/".concat(De.a.extname(t).split(".")[1])})}),Object(T.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer",zIndex:1},onClick:function(){return a(t)}})]})},t):".mp3"===De.a.extname(t)||".ogg"===De.a.extname(t)||".mpeg"===De.a.extname(t)?Object(T.jsx)(x.a,{xs:12,className:"g-2",children:Object(T.jsxs)("div",{className:"position-relative",children:[Object(T.jsx)("audio",{controls:!0,children:Object(T.jsx)("source",{src:t,type:"audio/".concat(De.a.extname(t).split(".")[1])})}),Object(T.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer"},onClick:function(){return a(t)}})]})},t):(console.log(s.current.offsetHeight),Object(T.jsx)(x.a,{xs:12,md:6,className:"g-2",children:Object(T.jsx)(fe.a,{elevation:5,className:"mb-0 py-3 px-3 rounded position-relative",style:{backgroundColor:"#616161"},children:Object(T.jsxs)("div",{className:"d-flex justify-content-between align-items-center",style:{width:200},children:[Object(T.jsx)(Pe.a,{className:"text-white"}),Object(T.jsx)("span",{className:"col-4 text-truncate text-white",children:t.split("/")[2]}),Object(T.jsx)("span",{className:"text-white",children:De.a.extname(t)}),Object(T.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer"},onClick:function(){return a(t)}})]})})},t))},He=function(){var e=Object(r.c)((function(e){return e.userLogin})).user,t=Object(r.b)(),a=Object(l.g)(),s=Object(n.useState)([]),c=Object(h.a)(s,2),j=c[0],w=c[1],k=Object(i.useToasts)().addToast,C=Object(n.useState)({}),S=Object(h.a)(C,2),L=S[0],U=S[1],I=Object(n.useState)([]),E=Object(h.a)(I,2),R=E[0],F=E[1],P=Object(n.useState)(""),M=Object(h.a)(P,2),z=M[0],B=M[1],W=Object(n.useState)(""),G=Object(h.a)(W,2),H=G[0],J=G[1],$=Object(n.useState)([]),ae=Object(h.a)($,2),re=ae[0],oe=ae[1],je=Object(n.useState)(!1),ue=Object(h.a)(je,2),he=ue[0],pe=ue[1],fe=Object(n.useState)(!1),Oe=Object(h.a)(fe,2),ge=Oe[0],ve=Oe[1],we=Object(n.useState)({}),ye=Object(h.a)(we,2),Ne=ye[0],_e=ye[1],ke=Object(n.useState)(""),Ce=Object(h.a)(ke,2),Se=Ce[0],Le=Ce[1],Ue=Object(n.useState)(!1),De=Object(h.a)(Ue,2),Ie=De[0],Ee=De[1],Re=Object(n.useState)(!1),Ae=Object(h.a)(Re,2),Fe=Ae[0],Pe=Ae[1],Te=Object(n.useRef)(0),Me=Object(n.useRef)(0),Be=Object(n.useRef)(0),He=Object(n.useRef)(null),Je=new Audio("/msg_sound.mp3"),Ye=Object(n.useState)(null),Ke=Object(h.a)(Ye,2),Qe=Ke[0],$e=Ke[1],qe=Boolean(Qe),Ve=function(){$e(null)},Xe=Object(n.useRef)(null);Object(n.useEffect)((function(){Xe.current=Object(se.io)("/"),Xe.current.on("user-joined",(function(t){var a=t.allUsers.filter((function(t){return t.email!==e.email}));w(a),t.joinedUser&&t.joinedUser.email!==e.email&&(null===e||void 0===e?void 0:e.isLoggedIn)?(k("".concat(t.joinedUser.name," is active"),{appearance:"info",autoDismiss:!0}),null!==L&&L.email===t.joinedUser.email&&U(t.joinedUser)):t.leavingUser&&t.leavingUser.email!==e.email&&(null===e||void 0===e?void 0:e.isLoggedIn)&&U(t.leavingUser)})),Xe.current.on("chat-message",(function(e){Je.play(),F((function(t){return[].concat(Object(u.a)(t),[e])}))})),Xe.current.on("removeMsgFromChat",function(){var e=Object(m.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("/api/v1/messages");case 3:a=e.sent,n=a.data,F(n.messages),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),Xe.current.emit("user-login",e);try{(function(){var e=Object(m.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("/api/v1/messages");case 2:t=e.sent,a=t.data,F(a.messages);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}catch(t){console.log(t)}return e||(null===e||void 0===e?void 0:e.isLoggedIn)||a.push("/"),window.innerWidth<991&&Ee(!0),window.addEventListener("resize",(function(){window.innerWidth<991&&Ee(!0)})),null!==Ne&&Ne.message&&He.current.focus(),function(){Xe.current.off("user-joined",(function(e){})),Xe.current.off("room-user-details",(function(e){})),Xe.current.off("chat-message",(function(e){})),Xe.current.off("removeMsgFromChat",(function(e){})),window.removeEventListener("resize",(function(){}))}}),[k,e,H,Ne]);var Ze=function(e){U(j.filter((function(t){return t.email===e}))[0])},et=function(){var t=Object(m.a)(d.a.mark((function t(a){var n,s,c,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),s={_id:Se,user:e._id,from:e.email,file:re,repliedOf:null!==(n=Ne.message)&&void 0!==n?n:"",to:L.email,message:z,sendAt:Date.now()},!(z&&"Enter"===a.key||z)){t.next=22;break}return B(""),t.prev=4,t.next=7,y.a.post("/api/v1/messages",s);case 7:c=t.sent,r=c.data,F([].concat(Object(u.a)(R),[r.message])),Xe.current.emit("message",r.message),pe(!1),oe([]),_e({}),Le(""),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(4),console.log(t.t0);case 20:t.next=23;break;case 22:k("Please Write something",{appearance:"info",autoDismiss:!0});case 23:case"end":return t.stop()}}),t,null,[[4,17]])})));return function(e){return t.apply(this,arguments)}}(),tt=function(){var e=Object(m.a)(d.a.mark((function e(t){var a,n,s,c,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.target.files,n=new FormData,s=0;s<a.length;s++)n.append("uploads",a[s]);return e.prev=3,e.next=6,y.a.post("/api/v1/upload",n);case 6:c=e.sent,(r=c.data).map((function(e){return oe((function(t){return[].concat(Object(u.a)(t),[e.filePath])}))})),r.length?pe(!0):pe(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.log(e.t0.response);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),at=function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split("/uploads/")[1],e.next=3,y.a.delete("/api/v1/upload/".concat(a));case 3:oe(re.filter((function(e){return e!==t}))),1===re.length?pe(!1):pe(!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),nt=function(){re.length&&(re.map((function(e){return at(e)})),re.length-1>0&&k("Remove ".concat(re.length-1," files"),{autoDismiss:!0,appearance:"info"})),re.length||pe(!he)},st=function(e){Xe.current.emit("messageDelete",e)},ct=function(e){Le(e),F(R.filter((function(t){return t._id!==e}))),B(R.filter((function(t){return t._id===e}))[0].message)},rt=function(e){_e(R.filter((function(t){return t._id===e}))[0])};return Object(T.jsxs)("div",{children:[Object(T.jsx)(g.a,{bg:"dark",className:"nav__bar",ref:Te,expand:"lg",children:Object(T.jsxs)(b.a,{fluid:"lg",children:[Object(T.jsx)(o.b,{to:"/",children:Object(T.jsxs)(g.a.Brand,{className:"text-white align-items-center",children:[Object(T.jsx)("img",{className:"app__logo me-2",height:"30px",src:"/logo.gif",alt:"logo"}),Object(T.jsx)("span",{className:"h4",children:"Chat-Buddy"})]})}),Object(T.jsxs)(v.a,{className:"ms-auto align-items-center",children:[Object(T.jsx)(v.a.Link,{className:"text-white fs-5",children:Object(T.jsx)(_.a,{onClick:function(e){$e(e.currentTarget)},size:"small",sx:{ml:2},children:Object(T.jsx)(N.a,{style:{width:32,height:32},src:e.photo,alt:e.name})})}),Object(T.jsxs)(V.a,{anchorEl:Qe,open:qe,onClose:Ve,onClick:Ve,style:{marginTop:Te.current.offsetHeight-15},PaperProps:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",mt:1.5,"& .MuiAvatar-root":{width:32,height:32,ml:-.5,mr:1},"&:before":{content:'""',display:"block",position:"absolute",top:0,right:14,width:10,height:10,bgcolor:"background.paper",transform:"translateY(-50%) rotate(45deg)",zIndex:0}}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[Object(T.jsxs)(X.a,{children:[Object(T.jsx)(N.a,{src:e.photo,alt:e.name,style:{width:32,height:32,marginRight:28}})," ",e.name]}),Object(T.jsx)(Z.a,{}),Object(T.jsxs)(X.a,{children:[Object(T.jsx)(ee.a,{children:Object(T.jsx)(be.a,{fontSize:"small"})}),"Settings"]}),Object(T.jsxs)(X.a,{onClick:function(){t(function(){var e=Object(m.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("user"),t({type:A});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Xe.current.disconnect(),a.push("/"),localStorage.removeItem("roomUser")},children:[Object(T.jsx)(ee.a,{children:Object(T.jsx)(ie.a,{fontSize:"small"})}),"Logout"]})]})]})]})}),Object(T.jsx)("section",{className:"bg__black",children:Object(T.jsx)(b.a,{fluid:"lg",children:Object(T.jsxs)(p.a,{children:[Object(T.jsxs)(x.a,{md:3,xs:12,style:{height:"calc(100vh - ".concat(Te.current.offsetHeight+Me.current.offsetHeight,"px)"),backgroundColor:"#1c2834"},children:[Object(T.jsx)("div",{className:"search__bar",children:Object(T.jsxs)(Y.a,{className:"py-3",children:[Object(T.jsx)(Y.a.Text,{id:"search",className:"bg-white border-end-0",children:Object(T.jsx)(q.a,{})}),Object(T.jsx)(K.a,{className:"border-start-0",placeholder:"Username","aria-label":"Username","aria-describedby":"search",value:H,onChange:function(e){return J(e.target.value)},type:"text"})]})}),j&&j.map((function(e){return Object(T.jsx)(We,{userInfo:e,messages:R,findRoomUser:Ze,setReplyMsgDetails:_e,setDisplayMessages:Pe,showMobileChat:Ie},e.email)}))]}),Object(T.jsx)(x.a,{md:9,xs:12,className:Ie?"bg-primary position-absolute top-0 end-0 bottom-0 start-0":"bg-primary",style:{display:Ie&&Fe?"block":Ie?"none":"block"},children:Object(T.jsx)("main",{className:"position-relative h-100",children:L.email?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)("section",{className:"message__header d-flex justify-content-between align-items-center py-4 px-2 border-bottom",id:"user__head",children:[Object(T.jsxs)("div",{className:"d-flex",children:[Object(T.jsx)(N.a,{alt:L.name,src:L.photo,style:{height:50,width:50,cursor:"pointer"},onClick:function(){return ve(!0)}}),Object(T.jsxs)("div",{className:"ps-3",children:[Object(T.jsx)("h4",{className:"text-white my-0",children:L.name}),Object(T.jsx)("p",{className:"text-white my-0",children:L.isActive?"Online":"Last Seen ".concat(ne()(L.updatedAt).calendar())})]})]}),Object(T.jsx)(_.a,{className:"float-end mobile__back_btn",onClick:function(){return Pe(!1)},children:Object(T.jsx)(xe.a,{className:"text-white"})})]}),Object(T.jsx)(ce.a,{className:"message__body overflow-auto position-relative",children:R&&R.map((function(t){return Object(T.jsx)(ze,{messageDetails:t,user:e,roomUser:L,removeFile:at,editMsg:ct,deleteMsg:st,replyMsg:rt},t.id)}))}),Object(T.jsx)("section",{className:"input__area position-absolute bottom-0 start-0 end-0",id:"text__area",children:Object(T.jsx)("form",{onSubmit:et,className:"mb-2",children:Object(T.jsxs)(p.a,{children:[null!==Ne&&Ne.message&&Object(T.jsx)(x.a,{xs:10,children:Object(T.jsx)("div",{className:"px-3 py-2 bg-primary position-relative",children:Object(T.jsxs)("p",{className:"mb-0 col-10 text-truncate text-white",children:[Object(T.jsx)("b",{children:"Replying to : "}),Ne.message," ",Object(T.jsx)(_.a,{className:"position-absolute top-0 end-0",onClick:function(){return _e("")},children:Object(T.jsx)(me.a,{className:"text-white bg-dark rounded-circle"})})]})})}),Object(T.jsx)(x.a,{xs:10,children:Object(T.jsx)(f.a.Group,{controlId:"formBasicEmail",ref:Be,children:Object(T.jsx)(f.a.Control,{value:z,onChange:function(e){return B(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?et(e):B(e.target.value)},ref:He,type:"text",as:"textarea",className:"rounded text__input bg-primary text-white",autoComplete:"off"})})}),Object(T.jsx)(x.a,{xs:1,children:Object(T.jsxs)("div",{className:"d-flex",children:[Object(T.jsxs)("label",{htmlFor:"icon-button-file",className:"float-end",children:[Object(T.jsx)(te.a,{id:"icon-button-file",type:"file",onChange:tt,hidden:!0}),Object(T.jsx)(_.a,{"aria-label":"upload picture",component:"span",className:"border p-2 input__file__button",children:Object(T.jsx)(de.a,{className:"attachments__icon text-dark"})})]}),Object(T.jsx)(O.a,{variant:"outline-secondary rounded-circle p-2 pl-3 shadow-lg float-start",className:"ms-2",type:"submit",children:Object(T.jsx)(le.a,{className:"attachments__icon"})})]})})]})})})]}):Object(T.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},children:Object(T.jsx)("h4",{className:"text-white",children:"Please Select a conversation"})})})})]})})}),Object(T.jsx)(g.a,{style:{background:"#000"},className:"nav__bar",ref:Me,expand:"lg",children:Object(T.jsxs)(b.a,{fluid:"md",children:[Object(T.jsxs)(v.a,{className:"me-auto align-items-center py-3 text-white",children:["Copyright ",Object(T.jsx)(D.a,{className:"me-2"})," ",(new Date).getFullYear()," ","e-Chat-Buddy. All rights reserved."]}),Object(T.jsx)(v.a,{className:"ms-auto align-items-center py-3 text-white",children:"Designed & Developed By Sazzad Bin Anwar"})]})}),Object(T.jsxs)(Q.a,{show:he,onHide:function(){return pe(!he)},fullscreen:"md-down",centered:!0,backdrop:"static",className:"shadow-lg",children:[Object(T.jsx)(Q.a.Header,{children:Object(T.jsxs)(Q.a.Title,{className:"position-relative w-100",children:["Upload File"," ",Object(T.jsx)(_.a,{className:"position-absolute top-0 end-0",onClick:function(){return nt()},children:Object(T.jsx)(me.a,{})})]})}),Object(T.jsx)(Q.a.Body,{children:Object(T.jsx)(p.a,{style:{maxHeight:450,overflowY:"auto"},children:re&&re.map((function(e){return Object(T.jsx)(Ge,{fileData:e,removeFile:at},e)}))})}),Object(T.jsxs)(Q.a.Footer,{children:[Object(T.jsx)(O.a,{variant:"secondary",onClick:function(){return nt()},children:"Close"}),Object(T.jsx)(O.a,{variant:"outline-primary",onClick:et,children:Object(T.jsx)(le.a,{className:"fs-7"})})]})]}),Object(T.jsxs)(Q.a,{show:ge,onHide:function(){return ve(!ge)},fullscreen:"md-down",centered:!0,className:"shadow-lg w-100",children:[Object(T.jsx)("img",{alt:L.name,src:L.photo}),Object(T.jsx)(_.a,{className:"position-absolute top-0 end-0",onClick:function(){return ve(!ge)},children:Object(T.jsx)(me.a,{className:"text-white bg-dark"})})]})]})},Je=function(){return console.log("hello"),Object(T.jsx)(b.a,{className:"mt-5",children:Object(T.jsx)(p.a,{children:Object(T.jsx)(x.a,{xs:12,md:3,children:Object(T.jsx)(fe.a,{elevation:5,className:"mb-0 p-1 border rounded d-flex justify-content-between align-items-center",style:{backgroundColor:"#616161"},children:Object(T.jsx)(Pe.a,{className:"text-white"})})})})})},Ye=function(){return Object(T.jsxs)(l.d,{children:[Object(T.jsx)(l.b,{path:"/login",component:J}),Object(T.jsx)(l.b,{path:"/test",component:Je}),Object(T.jsx)(G,{path:"/chat",children:Object(T.jsx)(He,{})}),Object(T.jsx)(l.b,{path:"/not-found",component:z}),Object(T.jsx)(l.b,{exact:!0,path:"/",component:M}),Object(T.jsx)(l.a,{to:"/not-found"})]})},Ke=(a(539),a(540),a(541),function(){return Object(T.jsx)(o.a,{children:Object(T.jsx)(l.b,{path:"/",component:Ye})})}),Qe=a(118),$e=a(316),qe=a(317),Ve=Object(Qe.combineReducers)({userLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return{loading:!0};case E:case F:return{loading:!1,user:t.payload};case P:case R:return{loading:!1,error:t.payload};case A:return{};default:return e}}}),Xe=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},Ze={userLogin:{user:Xe.isLoggedIn?Xe:{isLoggedIn:!1}}},et=[qe.a],tt=Object(Qe.createStore)(Ve,Ze,Object($e.composeWithDevTools)(Qe.applyMiddleware.apply(void 0,et))),at=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,594)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))},nt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function st(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(Object(T.jsx)(r.a,{store:tt,children:Object(T.jsx)(i.ToastProvider,{children:Object(T.jsx)(Ke,{})})}),document.getElementById("root")),at(),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");nt?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):st(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):st(t,e)}))}}()}},[[542,1,2]]]);
//# sourceMappingURL=main.fc9ba508.chunk.js.map