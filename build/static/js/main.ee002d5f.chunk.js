(this["webpackJsonpmern-pwa-project-template"]=this["webpackJsonpmern-pwa-project-template"]||[]).push([[0],{117:function(e){e.exports=JSON.parse('{"a":""}')},537:function(e,t,a){},538:function(e,t,a){},539:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(12),c=a.n(s),r=a(57),o=a(92),i=a(66),l=a(19),j=a(16),u=a.n(j),d=a(98),m=a(35),b=a(23),h=a(566),p=a(567),x=a(288),f=a(578),O=a(572),g=a(580),v=a(579),w=a(39),N=a.n(w),y=a(582),_=a(570),k=a(571),C=a(581),S=a(72),L=a.n(S),U=a(158),I=a.n(U),D="USER_LOGIN_REQUEST",A="USER_LOGIN_SUCCESS",E="USER_LOGIN_FAILED",F="USER_LOGOUT",T="USER_UPDATE_SUCCESS",R="USER_UPDATE_FAILED",P=a(1),B=function(){var e,t=Object(o.useToasts)().addToast,a=Object(r.c)((function(e){return e.userLogin})).user,s=Object(l.g)(),c=Object(r.b)(),i=Object(n.useState)(""),j=Object(b.a)(i,2),w=j[0],S=j[1],U=Object(n.useState)(""),F=Object(b.a)(U,2),T=F[0],R=F[1],B=Object(n.useState)([]),G=Object(b.a)(B,2),W=G[0],H=G[1],M=Object(n.useState)(!1),z=Object(b.a)(M,2),J=z[0],Y=z[1],Q=Object(n.useRef)(0),$=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.target.files,n=new FormData,s=0;s<a.length;s++)n.append("uploads",a[s]);return e.prev=3,e.next=6,N.a.post("/api/v1/upload",n);case 6:c=e.sent,c.data.map((function(e){return H((function(t){return[].concat(Object(d.a)(t),[e.filePath])}))})),Y(!0),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.log(e.t0.response);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(m.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split("/uploads/")[1],console.log({id:t,uploadId:a}),e.next=4,N.a.delete("/api/v1/upload/".concat(a));case 4:H(W.filter((function(e){return e!==t}))),Y(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){a&&(null===a||void 0===a?void 0:a.isLoggedIn)&&s.push("/chat")}),[s,c,a]);var K=function(){var e=Object(m.a)(u.a.mark((function e(){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!T||J){e.next=9;break}return e.next=4,N.a.get("/api/v1/user?email=".concat(T));case 4:a=e.sent,(n=a.data).isSuccess&&H([n.user.photo]),e.next=10;break;case 9:T?T&&J&&H([]):(t("Email can not be null",{autoDismiss:!0,appearance:"error"}),Y(!1));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return Object(P.jsxs)("div",{className:"bg-primary login__screen",children:[Object(P.jsxs)(h.a,{className:"",children:[Object(P.jsx)("h3",{className:"text-white pt-5 text-center",children:"e-chat-Buddy"}),Object(P.jsxs)(p.a,{children:[Object(P.jsx)(x.a,{lg:4}),Object(P.jsx)(x.a,{xs:12,md:12,lg:4,children:Object(P.jsxs)(f.a,{onSubmit:function(e){if(e.preventDefault(),w&&T){var a={name:w,email:T,photo:W[0]};c(function(e){return function(){var t=Object(m.a)(u.a.mark((function t(a){var n,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:D}),t.next=4,N.a.post("/api/v1/user",e);case 4:n=t.sent,s=n.data,console.log(s),localStorage.setItem("user",JSON.stringify(s.user)),a({type:A,payload:s.user}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),a({type:E,payload:t.t0.response?t.t0.response:t.t0.message});case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()}(a)),s.push("/chat")}else t("Name or Email can not be null",{autoDismiss:!0,appearance:"error"})},className:"my-5",children:[Object(P.jsxs)("div",{className:"d-flex justify-content-center align-items-center position-relative photo",children:[Object(P.jsx)(y.a,{alt:w,src:null!==(e=W[0])&&void 0!==e?e:"/logo.gif",style:{height:150,width:150},className:"shadow-lg border border-dark"}),W[0]&&Object(P.jsx)(_.a,{className:"position-absolute delete__icon",onClick:function(){return q(W[0])},children:Object(P.jsx)(L.a,{className:"text-white"})})]}),Object(P.jsxs)(f.a.Group,{className:"mb-3",controlId:"name",children:[Object(P.jsx)(f.a.Label,{className:"text-white",children:"User Name"}),Object(P.jsx)(f.a.Control,{value:w,onChange:function(e){return S(e.target.value)},type:"text",placeholder:"Enter Name",htmlFor:"name"})]}),Object(P.jsxs)(f.a.Group,{className:"mb-3",controlId:"email",children:[Object(P.jsx)(f.a.Label,{className:"text-white",children:"Email address"}),Object(P.jsx)(f.a.Control,{value:T,onChange:function(e){return R(e.target.value)},type:"email",placeholder:"Enter email",htmlFor:"email"})]}),Object(P.jsx)(k.a,{control:Object(P.jsx)(C.a,{checked:J,onChange:function(){Y(!J),K()},className:"text-white"}),label:"Photo is Uploaded",className:"text-white"}),!J&&Object(P.jsxs)(f.a.Group,{className:"mb-3",controlId:"photo",children:[Object(P.jsx)(f.a.Label,{className:"text-white",children:"Upload Your Photo"}),Object(P.jsx)("div",{className:"input-group mb-3",children:Object(P.jsx)("input",{type:"file",className:"form-control",accept:"image/*",onChange:$,placeholder:"Input Photos",id:"inputGroupFile02"})})]}),Object(P.jsx)(O.a,{variant:"outline-secondary w-100",type:"submit",children:"Login"})]})}),Object(P.jsx)(x.a,{lg:4})]})]}),Object(P.jsx)(g.a,{className:"nav__bar fixed-bottom",ref:Q,expand:"lg",children:Object(P.jsxs)(h.a,{className:"d-flex flex-column",children:[Object(P.jsxs)(v.a,{className:" align-items-center py-2 text-white",children:["Copyright ",Object(P.jsx)(I.a,{className:"me-2"})," ",(new Date).getFullYear()," ","e-Chat-Buddy. All rights reserved."]}),Object(P.jsx)(v.a,{className:"align-items-center pb-4 text-white",children:"Designed & Developed By Sazzad Bin Anwar"})]})})]})},G=function(){return Object(P.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},children:Object(P.jsx)("h4",{children:"404 | Page Not Found"})})},W=a(210),H=a(316),M=function(e){var t=e.children,a=Object(H.a)(e,["children"]),n=Object(r.c)((function(e){return e.userLogin})).user;return Object(P.jsx)(l.b,Object(W.a)(Object(W.a)({},a),{},{render:function(e){var a=e.location;return n&&n.isLoggedIn?t:Object(P.jsx)(l.a,{to:{pathname:"/",state:{from:a}}})}}))},z=a(541),J=function(){return Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(z.a,{component:"h1",variant:"h4",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"},children:"This is login page"})})},Y=a(575),Q=a(289),$=a(576),q=a(311),K=a.n(q),V=a(81),X=a.n(V),Z=a(293),ee=a(315),te=a(310),ae=a.n(te),ne=a(209),se=a.n(ne),ce=a(312),re=a.n(ce),oe=a(114),ie=a.n(oe),le=a(573),je=a(577),ue=a(583),de=a(207),me=a(118),be=a.n(me),he=a(116),pe=a.n(he),xe=a(82),fe=a.n(xe),Oe=a(208),ge=a.n(Oe),ve=a(8),we=a.n(ve),Ne=a(306),ye=a.n(Ne),_e=a(200),ke=a.n(_e),Ce=a(307),Se=a.n(Ce),Le=a(308),Ue=a.n(Le),Ie=a(117),De=function(e){var t=e.messageDetails,a=e.user,s=e.roomUser,c=e.editMsg,r=e.deleteMsg,o=e.replyMsg,i=Object(n.useState)(!1),l=Object(b.a)(i,2),j=l[0],u=l[1],d=Object(n.useState)(null),m=Object(b.a)(d,2),h=m[0],f=m[1],O=Object(n.useState)(""),g=Object(b.a)(O,2),v=g[0],w=g[1],N=Boolean(h),k=function(){f(null)};return console.log(j),a.email!==t.from&&s.email===t.from&&a.email===t.to?Object(P.jsxs)("div",{className:"d-flex my-3 chat__buddy",style:{marginRight:"20%"},children:[Object(P.jsx)(y.a,{alt:s.name,src:s.photo}),Object(P.jsxs)("div",{children:[t.message&&Object(P.jsx)(le.a,{body:!0,className:"chat__card chat__person ms-3 p-2",style:{width:"100%"},children:t.message.startsWith("http")?Object(P.jsx)(de.ReactTinyLink,{cardSize:"small",showGraphic:!0,maxLine:2,minLine:1,proxyUrl:"https://corsanywhere.herokuapp.com",url:t.message}):t.message}),t.file&&Object(P.jsx)(p.a,{children:t.file.map((function(e){return".png"===we.a.extname(e)||".jpg"===we.a.extname(e)||".jpeg"===we.a.extname(e)||".gif"===we.a.extname(e)?Object(P.jsx)(x.a,{xs:12,md:4,className:"g-2",children:Object(P.jsxs)(le.a,{elevation:5,className:"mb-0 ms-3 p-2 img__card",style:{cursor:"pointer",position:"relative",height:200,width:200},children:[Object(P.jsx)("img",{src:e,height:200,width:200,className:"position-absolute",alt:"upload-".concat(e),style:{right:0,top:0,bottom:0,left:0}}),Object(P.jsx)("div",{className:"position-absolute start-0 top-0 end-0 bottom-0 download__btn",children:Object(P.jsx)(be.a,{className:"bg-white rounded-circle position-absolute",style:{top:"50%",left:"50%",transform:"translate(-50%,-50%)",cursor:"pointer",zIndex:1},onClick:function(){return pe.a.saveAs("".concat(Ie.a).concat(e),"image.".concat(we.a.extname(e)))}})}),Object(P.jsx)("div",{className:"position-absolute start-0 top-0 end-0 bottom-0 download__btn",children:Object(P.jsx)(ge.a,{className:"bg-white rounded-circle position-absolute",style:{top:0,right:0,cursor:"pointer"},onClick:function(){u(!0),w(e)}})})]})},e):".mp4"===we.a.extname(e)||".mov"===we.a.extname(e)||".wmv"===we.a.extname(e)||".flv"===we.a.extname(e)||".webm"===we.a.extname(e)||".mkv"===we.a.extname(e)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsx)(le.a,{elevation:5,className:"mb-0 ms-3 p-2 img__card",style:{cursor:"pointer",position:"relative",height:400,width:400},children:Object(P.jsx)("video",{controls:!0,width:"100%",height:"400",children:Object(P.jsx)("source",{src:e,type:"video/".concat(we.a.extname(e).split(".")[1])})})})},e):".mp3"===we.a.extname(e)||".ogg"===we.a.extname(e)||".mpeg"===we.a.extname(e)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsx)("audio",{controls:!0,children:Object(P.jsx)("source",{src:e,type:"audio/".concat(we.a.extname(e).split(".")[1])})})},e):Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsx)(le.a,{elevation:5,className:"mb-0 ms-3 py-1 px-2 rounded",style:{backgroundColor:"#616161"},children:Object(P.jsxs)("div",{className:"d-flex justify-content-between align-items-center",style:{width:200},children:[Object(P.jsx)(fe.a,{className:"text-white"}),Object(P.jsx)("span",{className:"col-4 text-truncate text-white",children:e.split("/")[2]}),Object(P.jsx)("span",{className:"text-white",children:we.a.extname(e)}),Object(P.jsx)(_.a,{children:Object(P.jsx)(be.a,{className:"text-white",onClick:function(){return pe.a.saveAs("".concat(Ie.a).concat(e),"file.".concat(we.a.extname(e)))}})})]})})},e)}))}),Object(P.jsx)("p",{className:"text-white ms-3 mt-1 last__seen",children:X()(t.sendAt).fromNow()})]})]}):a.email===t.from&&s.email===t.to?Object(P.jsxs)("div",{className:"d-flex flex-column justify-content-end align-items-end my-3",style:{marginLeft:"20%"},children:[Object(P.jsxs)("div",{className:"d-flex my__chat text-right justify-content-end",children:[Object(P.jsxs)("div",{className:"chat__card me-3 d-flex justify-content-center align-items-center",children:[Object(P.jsx)(_.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:function(e){f(e.currentTarget)},className:"me-3",children:Object(P.jsx)(ye.a,{})}),Object(P.jsxs)(je.a,{id:"long-menu",anchorEl:h,keepMounted:!0,open:N,onClose:k,PaperProps:{style:{maxHeight:216}},children:[Object(P.jsx)(ue.a,{onClick:function(){k(),r(t._id)},children:Object(P.jsx)(ke.a,{})}),t.message&&Object(P.jsx)(ue.a,{onClick:function(){k(),c(t._id)},children:Object(P.jsx)(Se.a,{})}),Object(P.jsx)(ue.a,{onClick:function(){k(),o(t._id)},children:Object(P.jsx)(Ue.a,{})})]}),t.message&&Object(P.jsx)(le.a,{body:!0,className:"chat__person me-3 p-2",style:{width:"100%"},children:t.message.startsWith("http")?Object(P.jsx)(de.ReactTinyLink,{cardSize:"small",showGraphic:!0,maxLine:2,minLine:1,proxyUrl:"https://corsanywhere.herokuapp.com",url:t.message}):t.message}),t.file&&Object(P.jsx)(p.a,{children:t.file.map((function(e){return".png"===we.a.extname(e)||".jpg"===we.a.extname(e)||".jpeg"===we.a.extname(e)||".gif"===we.a.extname(e)?Object(P.jsx)(x.a,{xs:12,md:4,className:"g-2",children:Object(P.jsxs)(le.a,{elevation:5,className:"mb-0 img__card",style:{cursor:"pointer",position:"relative",height:200,width:200},children:[Object(P.jsx)("img",{src:e,height:200,width:200,className:"position-absolute",alt:"upload-".concat(e),style:{right:0,top:0,bottom:0,left:0}}),Object(P.jsx)("div",{className:"position-absolute start-0 top-0 end-0 bottom-0 download__btn",children:Object(P.jsx)(be.a,{className:"bg-white rounded-circle position-absolute",style:{top:"50%",left:"50%",transform:"translate(-50%,-50%)",cursor:"pointer",zIndex:1},onClick:function(){return pe.a.saveAs("".concat(Ie.a).concat(e),"image.".concat(we.a.extname(e)))}})}),Object(P.jsx)("div",{className:"position-absolute start-0 top-0 end-0 bottom-0 download__btn",children:Object(P.jsx)(ge.a,{className:"bg-white rounded-circle position-absolute",style:{top:0,right:0,cursor:"pointer"},onClick:function(){u(!0),w(e)}})})]})},e):".mp4"===we.a.extname(e)||".mov"===we.a.extname(e)||".wmv"===we.a.extname(e)||".flv"===we.a.extname(e)||".webm"===we.a.extname(e)||".mkv"===we.a.extname(e)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsx)(le.a,{elevation:5,className:"mb-0 img__card",style:{cursor:"pointer",position:"relative",height:400,width:400},children:Object(P.jsx)("video",{controls:!0,width:"100%",height:"400",children:Object(P.jsx)("source",{src:e,type:"video/".concat(we.a.extname(e).split(".")[1])})})})},e):".mp3"===we.a.extname(e)||".ogg"===we.a.extname(e)||".mpeg"===we.a.extname(e)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsx)("audio",{controls:!0,children:Object(P.jsx)("source",{src:e,type:"audio/".concat(we.a.extname(e).split(".")[1])})})},e):Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsx)(le.a,{elevation:5,className:"mb-0 py-1 px-2 rounded",style:{backgroundColor:"#616161"},children:Object(P.jsxs)("div",{className:"d-flex justify-content-between align-items-center",style:{width:200},children:[Object(P.jsx)(fe.a,{className:"text-white"}),Object(P.jsx)("span",{className:"col-4 text-truncate text-white",children:e.split("/")[2]}),Object(P.jsx)("span",{className:"text-white",children:we.a.extname(e)}),Object(P.jsx)(_.a,{children:Object(P.jsx)(be.a,{className:"text-white",onClick:function(){return pe.a.saveAs("".concat(Ie.a).concat(e),"file.".concat(we.a.extname(e)))}})})]})})},e)}))})]}),Object(P.jsx)(y.a,{alt:a.name,src:a.photo})]}),Object(P.jsx)("p",{className:"text-white me-5 mt-1 pe-3 last__seen",children:X()(t.sendAt).fromNow()}),Object(P.jsxs)($.a,{show:j,onHide:function(){return u(!j)},fullscreen:"md-down",centered:!0,className:"shadow-lg w-100",children:[Object(P.jsx)("img",{alt:v,src:v}),Object(P.jsx)(ie.a,{className:"bg-white rounded-circle position-absolute",style:{top:"-10px",right:"-10px",cursor:"pointer"},onClick:function(){return u(!j)}})]})]}):(s.email,t.to,null)},Ae=a(574),Ee=function(e){var t=e.userInfo,a=e.messages,n=e.findRoomUser;return Object(P.jsxs)(le.a,{elevation:10,body:!0,className:t.isActive?"bg-success p-2 d-flex align-items-center mb-3":"bg-dark p-2 d-flex align-items-center mb-3",style:{cursor:"pointer"},onClick:function(){n(t.email)},children:[Object(P.jsx)(Ae.a,{badgeContent:t.isActive?a.filter((function(e){return e.from===t.email})).length:0,color:"primary",children:Object(P.jsx)(y.a,{alt:t.name,src:t.photo,className:"shadow-lg border"})}),Object(P.jsxs)("div",{className:"ps-3 ",children:[Object(P.jsx)("p",{className:"text-white my-0 fs-6 user__name_list",children:t.name}),Object(P.jsx)("p",{className:"text-white my-0 last__seen",children:t.isActive?"Online":"Active ".concat(X()(t.updatedAt).fromNow())})]})]})},Fe=function(e){var t=e.fileData,a=e.removeFile,s=Object(n.useRef)(0);return".png"===we.a.extname(t)||".jpg"===we.a.extname(t)||".jpeg"===we.a.extname(t)||".gif"===we.a.extname(t)?Object(P.jsx)(x.a,{xs:12,md:6,className:"g-2",children:Object(P.jsxs)(le.a,{elevation:5,className:"mb-0 img__card",style:{position:"relative",height:200,width:200},children:[Object(P.jsx)("img",{src:t,height:200,width:200,className:"position-absolute",alt:"upload-".concat(t),style:{right:0,top:0,bottom:0,left:0}}),Object(P.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer"},onClick:function(){return a(t)}})]})},t):".mp4"===we.a.extname(t)||".mov"===we.a.extname(t)||".wmv"===we.a.extname(t)||".flv"===we.a.extname(t)||".webm"===we.a.extname(t)||".mkv"===we.a.extname(t)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsxs)(le.a,{elevation:5,className:"mb-0 img__card",style:{position:"relative"},children:[Object(P.jsx)("video",{controls:!0,width:"100%",height:"400",children:Object(P.jsx)("source",{src:t,type:"video/".concat(we.a.extname(t).split(".")[1])})}),Object(P.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer",zIndex:1},onClick:function(){return a(t)}})]})},t):".mp3"===we.a.extname(t)||".ogg"===we.a.extname(t)||".mpeg"===we.a.extname(t)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsxs)("div",{className:"position-relative",children:[Object(P.jsx)("audio",{controls:!0,children:Object(P.jsx)("source",{src:t,type:"audio/".concat(we.a.extname(t).split(".")[1])})}),Object(P.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer"},onClick:function(){return a(t)}})]})},t):(console.log(s.current.offsetHeight),Object(P.jsx)(x.a,{xs:12,md:6,className:"g-2",children:Object(P.jsx)(le.a,{elevation:5,className:"mb-0 py-3 px-3 rounded position-relative",style:{backgroundColor:"#616161"},children:Object(P.jsxs)("div",{className:"d-flex justify-content-between align-items-center",style:{width:200},children:[Object(P.jsx)(fe.a,{className:"text-white"}),Object(P.jsx)("span",{className:"col-4 text-truncate text-white",children:t.split("/")[2]}),Object(P.jsx)("span",{className:"text-white",children:we.a.extname(t)}),Object(P.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer"},onClick:function(){return a(t)}})]})})},t))},Te=function(){var e=Object(r.c)((function(e){return e.userLogin})).user,t=Object(r.b)(),a=Object(l.g)(),s=Object(n.useState)([]),c=Object(b.a)(s,2),j=c[0],w=c[1],k=Object(o.useToasts)().addToast,C=Object(n.useState)({}),S=Object(b.a)(C,2),L=S[0],U=S[1],D=Object(n.useState)([]),A=Object(b.a)(D,2),E=A[0],T=A[1],R=Object(n.useState)(""),B=Object(b.a)(R,2),G=B[0],W=B[1],H=Object(n.useState)(""),M=Object(b.a)(H,2),z=M[0],J=M[1],q=Object(n.useState)([]),V=Object(b.a)(q,2),te=V[0],ne=V[1],ce=Object(n.useState)(!1),oe=Object(b.a)(ce,2),le=oe[0],je=oe[1],ue=Object(n.useState)(!1),de=Object(b.a)(ue,2),me=de[0],be=de[1],he=Object(n.useState)({}),pe=Object(b.a)(he,2),xe=(pe[0],pe[1]),fe=Object(n.useRef)(0),Oe=Object(n.useRef)(0),ge=new Audio("/msg_sound.mp3"),ve=Object(n.useRef)(null);Object(n.useEffect)((function(){ve.current=Object(Z.io)("/"),ve.current.on("user-joined",(function(t){var a=t.allUsers.filter((function(t){return t.email!==e.email}));t.joinedUser&&t.joinedUser.email!==e.email&&(null===e||void 0===e?void 0:e.isLoggedIn)?k("".concat(t.joinedUser.name," is active"),{appearance:"info",autoDismiss:!0}):t.leavingUser&&t.leavingUser.email!==e.email&&(null===e||void 0===e?void 0:e.isLoggedIn)&&U(t.leavingUser),w(a)})),ve.current.on("room-user-details",(function(e){U(e)})),ve.current.on("chat-message",(function(e){ge.play(),T((function(t){return[].concat(Object(d.a)(t),[e])}))})),ve.current.on("removeMsgFromChat",function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.a.get("/api/v1/messages");case 3:a=e.sent,n=a.data,T(n.messages),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:console.log(E);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),ve.current.emit("user-login",e);try{(function(){var e=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.get("/api/v1/messages");case 2:t=e.sent,a=t.data,T(a.messages);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}catch(t){console.log(t)}return e||(null===e||void 0===e?void 0:e.isLoggedIn)||a.push("/"),function(){ve.current.off("user-joined",(function(e){})),ve.current.off("room-user-details",(function(e){})),ve.current.off("chat-message",(function(e){})),ve.current.off("removeMsgFromChat",(function(e){}))}}),[k,e,z]);var we=function(e){U(j.filter((function(t){return t.email===e}))[0])},Ne=function(){var t=Object(m.a)(u.a.mark((function t(a){var n,s,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n={user:e._id,from:e.email,file:te,to:L.email,message:G,sendAt:Date.now()},!(G&&te||te)){t.next=20;break}return W(""),t.prev=4,t.next=7,N.a.post("/api/v1/messages",n);case 7:s=t.sent,c=s.data,T([].concat(Object(d.a)(E),[c.message])),ve.current.emit("message",c.message),je(!1),ne([]),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(4),console.log(t.t0);case 18:t.next=21;break;case 20:k("Please Write something",{appearance:"info",autoDismiss:!0});case 21:case"end":return t.stop()}}),t,null,[[4,15]])})));return function(e){return t.apply(this,arguments)}}(),ye=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.target.files,n=new FormData,s=0;s<a.length;s++)n.append("uploads",a[s]);return e.prev=3,e.next=6,N.a.post("/api/v1/upload",n);case 6:c=e.sent,c.data.map((function(e){return ne((function(t){return[].concat(Object(d.a)(t),[e.filePath])}))})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.log(e.t0.response);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e=Object(m.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split("/uploads/")[1],e.next=3,N.a.delete("/api/v1/upload/".concat(a));case 3:ne(te.filter((function(e){return e!==t})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ke=function(){te.length&&(te.map((function(e){return _e(e)})),te.length-1>0&&k("Remove ".concat(te.length-1," files"),{autoDismiss:!0,appearance:"info"})),te.length||je(!le)},Ce=function(e){ve.current.emit("messageDelete",e)},Se=function(e){},Le=function(e){xe(E.find((function(t){return t._id===e})))};return Object(P.jsxs)("div",{children:[Object(P.jsx)(g.a,{bg:"dark",className:"nav__bar",ref:fe,expand:"lg",children:Object(P.jsxs)(h.a,{fluid:"md",children:[Object(P.jsx)(i.b,{to:"/",children:Object(P.jsxs)(g.a.Brand,{className:"text-white align-items-center",children:[Object(P.jsx)("img",{className:"app__logo me-2",height:"30px",src:"/logo.gif",alt:"logo"}),Object(P.jsx)("span",{className:"h4",children:"Chat-Buddy"})]})}),Object(P.jsx)(g.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(P.jsx)(g.a.Collapse,{id:"basic-navbar-nav",children:Object(P.jsxs)(v.a,{className:"ms-auto align-items-center",children:[Object(P.jsx)(v.a.Link,{className:"text-white fs-5",children:Object(P.jsx)(i.c,{to:"/",children:"Home"})}),Object(P.jsx)(v.a.Link,{className:"text-white fs-5",children:e.name}),Object(P.jsx)(v.a.Link,{className:"text-white fs-5",children:e.email}),Object(P.jsx)(v.a.Link,{className:"text-white",children:Object(P.jsxs)(_.a,{className:"fs-7",onClick:function(){t(function(){var e=Object(m.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("user"),t({type:F});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ve.current.disconnect(),a.push("/")},children:[Object(P.jsx)(ae.a,{className:"text-white"}),Object(P.jsx)("span",{className:"logout",children:"Logout"})," "]})})]})})]})}),Object(P.jsx)("section",{className:"bg__black",children:Object(P.jsx)(h.a,{fluid:"lg",children:Object(P.jsxs)(p.a,{children:[Object(P.jsxs)(x.a,{md:3,style:{height:"calc(100vh - ".concat(fe.current.offsetHeight+Oe.current.offsetHeight,"px)"),backgroundColor:"#1c2834"},children:[Object(P.jsx)("div",{className:"search__bar",children:Object(P.jsxs)(Y.a,{className:"py-3",children:[Object(P.jsx)(Y.a.Text,{id:"search",className:"bg-white border-end-0",children:Object(P.jsx)(K.a,{})}),Object(P.jsx)(Q.a,{className:"border-start-0",placeholder:"Username","aria-label":"Username","aria-describedby":"search",value:z,onChange:function(e){return J(e.target.value)},type:"text"})]})}),j&&j.map((function(e){return Object(P.jsx)(Ee,{userInfo:e,messages:E,findRoomUser:we},e.email)}))]}),Object(P.jsx)(x.a,{md:9,className:"bg-primary",children:Object(P.jsx)("main",{className:"position-relative h-100",children:L.name?Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("section",{className:"message__header d-flex align-items-center py-4 px-2 border-bottom",id:"user__head",children:[Object(P.jsx)(y.a,{alt:L.name,src:L.photo,style:{height:50,width:50,cursor:"pointer"},onClick:function(){return be(!0)}}),Object(P.jsxs)("div",{className:"ps-3",children:[Object(P.jsx)("h4",{className:"text-white my-0",children:L.name}),Object(P.jsx)("p",{className:"text-white my-0",children:L.isActive?"Online":"Last Seen ".concat(X()(L.updatedAt).calendar())})]})]}),Object(P.jsx)(ee.a,{className:"message__body overflow-auto position-relative",children:E&&E.map((function(t){return Object(P.jsx)(De,{messageDetails:t,user:e,roomUser:L,removeFile:_e,editMsg:Se,deleteMsg:Ce,replyMsg:Le},t.id)}))}),Object(P.jsx)("section",{className:"input__area position-absolute bottom-0 start-0 end-0",id:"text__area",children:Object(P.jsxs)("form",{onSubmit:Ne,className:"d-flex justify-content-center align-items-center mb-2",children:[Object(P.jsx)(f.a.Group,{className:"w-100",controlId:"exampleForm.ControlTextarea1",children:Object(P.jsx)(f.a.Control,{value:G,onChange:function(e){return W(e.target.value)},as:"textarea",row:1})}),Object(P.jsx)(O.a,{variant:"outline-secondary rounded-circle p-2 pl-3",className:"ms-2",onClick:function(){return je(!le)},children:Object(P.jsx)(re.a,{className:"fs-7"})}),Object(P.jsx)(O.a,{variant:"outline-secondary rounded-circle p-2 pl-3 shadow-lg",className:"ms-2",type:"submit",children:Object(P.jsx)(se.a,{className:"fs-7"})})]})})]}):Object(P.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},children:Object(P.jsx)("h4",{className:"text-white",children:"Please Select a conversation"})})})})]})})}),Object(P.jsx)(g.a,{style:{background:"#000"},className:"nav__bar ",ref:Oe,expand:"lg",children:Object(P.jsxs)(h.a,{fluid:"md",children:[Object(P.jsxs)(v.a,{className:"me-auto align-items-center py-3 text-white",children:["Copyright ",Object(P.jsx)(I.a,{className:"me-2"})," ",(new Date).getFullYear()," ","e-Chat-Buddy. All rights reserved."]}),Object(P.jsx)(v.a,{className:"ms-auto align-items-center py-3 text-white",children:"Designed & Developed By Sazzad Bin Anwar"})]})}),Object(P.jsxs)($.a,{show:le,onHide:function(){return je(!le)},fullscreen:"md-down",centered:!0,backdrop:"static",className:"shadow-lg",children:[Object(P.jsx)($.a.Header,{children:Object(P.jsxs)($.a.Title,{className:"position-relative w-100",children:["Upload File"," ",Object(P.jsx)(_.a,{className:"position-absolute top-0 end-0",onClick:function(){return ke()},children:Object(P.jsx)(ie.a,{})})]})}),Object(P.jsxs)($.a.Body,{children:[Object(P.jsxs)(f.a.Group,{className:"mb-3",controlId:"photo",children:[Object(P.jsx)(f.a.Label,{className:"text-black",children:"Upload Your file"}),Object(P.jsx)("div",{className:"input-group mb-3",children:Object(P.jsx)("input",{type:"file",className:"form-control",onChange:ye,placeholder:"Input Photos",id:"inputGroupFile02",multiple:!0})})]}),Object(P.jsx)(p.a,{style:{maxHeight:450,overflowY:"auto"},children:te&&te.map((function(e){return Object(P.jsx)(Fe,{fileData:e,removeFile:_e},e)}))})]}),Object(P.jsxs)($.a.Footer,{children:[Object(P.jsx)(O.a,{variant:"secondary",onClick:function(){return ke()},children:"Close"}),Object(P.jsx)(O.a,{variant:"outline-primary",onClick:Ne,children:Object(P.jsx)(se.a,{className:"fs-7"})})]})]}),Object(P.jsxs)($.a,{show:me,onHide:function(){return be(!me)},fullscreen:"md-down",centered:!0,className:"shadow-lg w-100",children:[Object(P.jsx)("img",{alt:L.name,src:L.photo}),Object(P.jsx)(_.a,{className:"position-absolute top-0 end-0 bg-dark",onClick:function(){return be(!me)},children:Object(P.jsx)(ie.a,{className:"text-white"})})]})]})},Re=function(){return console.log("hello"),Object(P.jsx)(h.a,{className:"mt-5",children:Object(P.jsx)(p.a,{children:Object(P.jsx)(x.a,{xs:12,md:3,children:Object(P.jsx)(le.a,{elevation:5,className:"mb-0 p-1 border rounded d-flex justify-content-between align-items-center",style:{backgroundColor:"#616161"},children:Object(P.jsx)(fe.a,{className:"text-white"})})})})})},Pe=function(){return Object(P.jsxs)(l.d,{children:[Object(P.jsx)(l.b,{path:"/login",component:J}),Object(P.jsx)(l.b,{path:"/test",component:Re}),Object(P.jsx)(M,{path:"/chat",children:Object(P.jsx)(Te,{})}),Object(P.jsx)(l.b,{path:"/not-found",component:G}),Object(P.jsx)(l.b,{exact:!0,path:"/",component:B}),Object(P.jsx)(l.a,{to:"/not-found"})]})},Be=(a(536),a(537),a(538),function(){return Object(P.jsx)(i.a,{children:Object(P.jsx)(l.b,{path:"/",component:Pe})})}),Ge=a(115),We=a(313),He=a(314),Me=Object(Ge.combineReducers)({userLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return{loading:!0};case A:case T:return{loading:!1,user:t.payload};case R:case E:return{loading:!1,error:t.payload};case F:return{};default:return e}}}),ze=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},Je={userLogin:{user:ze.isLoggedIn?ze:{isLoggedIn:!1}}},Ye=[He.a],Qe=Object(Ge.createStore)(Me,Je,Object(We.composeWithDevTools)(Ge.applyMiddleware.apply(void 0,Ye))),$e=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,585)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))},qe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ke(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(Object(P.jsx)(r.a,{store:Qe,children:Object(P.jsx)(o.ToastProvider,{children:Object(P.jsx)(Be,{})})}),document.getElementById("root")),$e(),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");qe?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ke(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Ke(t,e)}))}}()}},[[539,1,2]]]);
//# sourceMappingURL=main.ee002d5f.chunk.js.map