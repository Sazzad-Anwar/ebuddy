(this["webpackJsonpmern-pwa-project-template"]=this["webpackJsonpmern-pwa-project-template"]||[]).push([[0],{158:function(e){e.exports=JSON.parse('{"a":""}')},538:function(e,t,a){},539:function(e,t,a){},540:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(12),c=a.n(s),r=a(57),i=a(93),o=a(67),l=a(20),j=a(17),u=a.n(j),d=a(99),m=a(35),h=a(23),b=a(569),p=a(570),x=a(291),f=a(581),O=a(575),g=a(583),v=a(582),w=a(39),N=a.n(w),y=a(586),_=a(573),k=a(574),C=a(584),S=a(73),L=a.n(S),U=a(156),I=a.n(U),D="USER_LOGIN_REQUEST",E="USER_LOGIN_SUCCESS",A="USER_LOGIN_FAILED",F="USER_LOGOUT",R="USER_UPDATE_SUCCESS",T="USER_UPDATE_FAILED",P=a(2),B=function(){var e,t=Object(i.useToasts)().addToast,a=Object(r.c)((function(e){return e.userLogin})).user,s=Object(l.g)(),c=Object(r.b)(),o=Object(n.useState)(""),j=Object(h.a)(o,2),w=j[0],S=j[1],U=Object(n.useState)(""),F=Object(h.a)(U,2),R=F[0],T=F[1],B=Object(n.useState)([]),W=Object(h.a)(B,2),G=W[0],H=W[1],M=Object(n.useState)(!1),z=Object(h.a)(M,2),J=z[0],Y=z[1],K=Object(n.useRef)(0),Q=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.target.files,n=new FormData,s=0;s<a.length;s++)n.append("uploads",a[s]);return e.prev=3,e.next=6,N.a.post("/api/v1/upload",n);case 6:c=e.sent,c.data.map((function(e){return H((function(t){return[].concat(Object(d.a)(t),[e.filePath])}))})),Y(!0),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.log(e.t0.response);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(m.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split("/uploads/")[1],console.log({id:t,uploadId:a}),e.next=4,N.a.delete("/api/v1/upload/".concat(a));case 4:H(G.filter((function(e){return e!==t}))),Y(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){a&&(null===a||void 0===a?void 0:a.isLoggedIn)&&s.push("/chat")}),[s,c,a]);var q=function(){var e=Object(m.a)(u.a.mark((function e(){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!R||J){e.next=9;break}return e.next=4,N.a.get("/api/v1/user?email=".concat(R));case 4:a=e.sent,(n=a.data).isSuccess&&H([n.user.photo]),e.next=10;break;case 9:R?R&&J&&H([]):(t("Email can not be null",{autoDismiss:!0,appearance:"error"}),Y(!1));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return Object(P.jsxs)("div",{className:"bg-primary login__screen",children:[Object(P.jsxs)(b.a,{className:"",children:[Object(P.jsx)("h3",{className:"text-white pt-5 text-center",children:"e-chat-Buddy"}),Object(P.jsxs)(p.a,{children:[Object(P.jsx)(x.a,{lg:4}),Object(P.jsx)(x.a,{xs:12,md:12,lg:4,children:Object(P.jsxs)(f.a,{onSubmit:function(e){if(e.preventDefault(),w&&R){var a={name:w,email:R,photo:G[0]};c(function(e){return function(){var t=Object(m.a)(u.a.mark((function t(a){var n,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:D}),t.next=4,N.a.post("/api/v1/user",e);case 4:n=t.sent,s=n.data,console.log(s),localStorage.setItem("user",JSON.stringify(s.user)),a({type:E,payload:s.user}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),a({type:A,payload:t.t0.response?t.t0.response:t.t0.message});case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()}(a)),s.push("/chat")}else t("Name or Email can not be null",{autoDismiss:!0,appearance:"error"})},className:"my-5",children:[Object(P.jsxs)("div",{className:"d-flex justify-content-center align-items-center position-relative photo",children:[Object(P.jsx)(y.a,{alt:w,src:null!==(e=G[0])&&void 0!==e?e:"/logo.gif",style:{height:150,width:150},className:"shadow-lg border border-dark"}),G[0]&&Object(P.jsx)(_.a,{className:"position-absolute delete__icon",onClick:function(){return $(G[0])},children:Object(P.jsx)(L.a,{className:"text-white"})})]}),Object(P.jsxs)(f.a.Group,{className:"mb-3",controlId:"name",children:[Object(P.jsx)(f.a.Label,{className:"text-white",children:"User Name"}),Object(P.jsx)(f.a.Control,{value:w,onChange:function(e){return S(e.target.value)},type:"text",placeholder:"Enter Name",htmlFor:"name"})]}),Object(P.jsxs)(f.a.Group,{className:"mb-3",controlId:"email",children:[Object(P.jsx)(f.a.Label,{className:"text-white",children:"Email address"}),Object(P.jsx)(f.a.Control,{value:R,onChange:function(e){return T(e.target.value)},type:"email",placeholder:"Enter email",htmlFor:"email"})]}),Object(P.jsx)(k.a,{control:Object(P.jsx)(C.a,{checked:J,onChange:function(){Y(!J),q()},className:"text-white"}),label:"Photo is Uploaded",className:"text-white"}),!J&&Object(P.jsxs)(f.a.Group,{className:"mb-3",controlId:"photo",children:[Object(P.jsx)(f.a.Label,{className:"text-white",children:"Upload Your Photo"}),Object(P.jsx)("div",{className:"input-group mb-3",children:Object(P.jsx)("input",{type:"file",className:"form-control",accept:"image/*",onChange:Q,placeholder:"Input Photos",id:"inputGroupFile02"})})]}),Object(P.jsx)(O.a,{variant:"outline-secondary w-100",type:"submit",children:"Login"})]})}),Object(P.jsx)(x.a,{lg:4})]})]}),Object(P.jsx)(g.a,{className:"nav__bar fixed-bottom",ref:K,expand:"lg",children:Object(P.jsxs)(b.a,{className:"d-flex flex-column",children:[Object(P.jsxs)(v.a,{className:" align-items-center py-2 text-white",children:["Copyright ",Object(P.jsx)(I.a,{className:"me-2"})," ",(new Date).getFullYear()," ","e-Chat-Buddy. All rights reserved."]}),Object(P.jsx)(v.a,{className:"align-items-center pb-4 text-white",children:"Designed & Developed By Sazzad Bin Anwar"})]})})]})},W=function(){return Object(P.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},children:Object(P.jsx)("h4",{children:"404 | Page Not Found"})})},G=a(214),H=a(317),M=function(e){var t=e.children,a=Object(H.a)(e,["children"]),n=Object(r.c)((function(e){return e.userLogin})).user;return Object(P.jsx)(l.b,Object(G.a)(Object(G.a)({},a),{},{render:function(e){var a=e.location;return n&&n.isLoggedIn?t:Object(P.jsx)(l.a,{to:{pathname:"/",state:{from:a}}})}}))},z=a(542),J=function(){return Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(z.a,{component:"h1",variant:"h4",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"},children:"This is login page"})})},Y=a(578),K=a(292),Q=a(579),$=a(312),q=a.n($),V=a(585),X=a(83),Z=a.n(X),ee=a(296),te=a(316),ae=a(311),ne=a.n(ae),se=a(213),ce=a.n(se),re=a(313),ie=a.n(re),oe=a(117),le=a.n(oe),je=a(576),ue=a(580),de=a(587),me=a(210),he=a(157),be=a.n(he),pe=a(11),xe=a.n(pe),fe=a(211),Oe=a.n(fe),ge=a(202),ve=a.n(ge),we=a(309),Ne=a.n(we),ye=a(212),_e=a.n(ye),ke=a(158),Ce=a(201),Se=a.n(Ce),Le=a(159),Ue=a.n(Le),Ie=a(79),De=a.n(Ie),Ee=function(e){var t=e.fileData,a=e.setShow,n=e.setChatImage;return".png"===xe.a.extname(t)||".jpg"===xe.a.extname(t)||".jpeg"===xe.a.extname(t)||".gif"===xe.a.extname(t)?Object(P.jsx)(x.a,{xs:12,md:4,className:"g-2",children:Object(P.jsxs)(je.a,{elevation:5,className:"mb-0 img__card",style:{cursor:"pointer",position:"relative",height:200,width:200},children:[Object(P.jsx)("img",{src:t,height:200,width:200,className:"position-absolute",alt:"upload-".concat(t),style:{right:0,top:0,bottom:0,left:0}}),Object(P.jsx)("div",{className:"position-absolute start-0 top-0 end-0 bottom-0 download__btn",children:Object(P.jsx)(Ue.a,{className:"bg-white rounded-circle position-absolute",style:{top:"50%",left:"50%",transform:"translate(-50%,-50%)",cursor:"pointer",zIndex:1},onClick:function(){return be.a.saveAs("".concat(ke.a).concat(t),"image.".concat(xe.a.extname(t)))}})}),Object(P.jsx)("div",{className:"position-absolute start-0 top-0 end-0 bottom-0 download__btn",children:Object(P.jsx)(Se.a,{className:"bg-white rounded-circle position-absolute",style:{top:0,right:0,cursor:"pointer"},onClick:function(){a(!0),n(t)}})})]})},t):".mp4"===xe.a.extname(t)||".mov"===xe.a.extname(t)||".wmv"===xe.a.extname(t)||".flv"===xe.a.extname(t)||".webm"===xe.a.extname(t)||".mkv"===xe.a.extname(t)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsx)(je.a,{elevation:5,className:"mb-0 img__card",style:{cursor:"pointer",position:"relative",height:400,width:400},children:Object(P.jsx)("video",{controls:!0,width:"100%",height:"400",children:Object(P.jsx)("source",{src:t,type:"video/".concat(xe.a.extname(t).split(".")[1])})})})},t):".mp3"===xe.a.extname(t)||".ogg"===xe.a.extname(t)||".mpeg"===xe.a.extname(t)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsx)("audio",{controls:!0,children:Object(P.jsx)("source",{src:t,type:"audio/".concat(xe.a.extname(t).split(".")[1])})})},t):Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsx)(je.a,{elevation:5,className:"mb-0 py-1 px-2 rounded",style:{backgroundColor:"#616161"},children:Object(P.jsxs)("div",{className:"d-flex justify-content-between align-items-center",style:{width:200},children:[Object(P.jsx)(De.a,{className:"text-white"}),Object(P.jsx)("span",{className:"col-4 text-truncate text-white",children:t.split("/")[2]}),Object(P.jsx)("span",{className:"text-white",children:xe.a.extname(t)}),Object(P.jsx)(_.a,{children:Object(P.jsx)(Ue.a,{className:"text-white",onClick:function(){return be.a.saveAs("".concat(ke.a).concat(t),"file.".concat(xe.a.extname(t)))}})})]})})},t)},Ae=function(e){var t=e.messageDetails,a=e.user,s=e.roomUser,c=e.editMsg,r=e.deleteMsg,i=e.replyMsg,o=Object(n.useState)(!1),l=Object(h.a)(o,2),j=l[0],u=l[1],d=Object(n.useState)(null),m=Object(h.a)(d,2),b=m[0],x=m[1],f=Object(n.useState)(""),O=Object(h.a)(f,2),g=O[0],v=O[1],w=Boolean(b),N=function(e){x(e.currentTarget)},k=function(){x(null)};return console.log(j),a.email!==t.from&&s.email===t.from&&a.email===t.to?Object(P.jsxs)("div",{className:"d-flex my-3 chat__buddy",style:{marginRight:"20%"},children:[Object(P.jsx)(y.a,{alt:s.name,src:s.photo}),Object(P.jsxs)("div",{children:[Object(P.jsxs)("div",{className:"d-flex",children:[t.message&&Object(P.jsxs)("div",{className:"chat__card chat__person ms-3 p-2",children:[t.repliedOf&&Object(P.jsx)(je.a,{body:!0,className:"chat__card chat__person p-2 bg-dark text-white col-4 text-truncate",style:{width:"100%"},children:t.repliedOf}),Object(P.jsx)(je.a,{body:!0,className:"chat__card chat__person p-2",style:{width:"100%"},children:t.message.startsWith("http")?Object(P.jsx)(me.ReactTinyLink,{cardSize:"small",showGraphic:!0,maxLine:2,minLine:1,proxyUrl:"https://corsanywhere.herokuapp.com",url:t.message}):t.message})]}),Object(P.jsx)(_.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:N,className:"ms-2",children:Object(P.jsx)(Oe.a,{})}),Object(P.jsx)(ue.a,{id:"long-menu",anchorEl:b,keepMounted:!0,open:w,onClose:k,PaperProps:{style:{maxHeight:216}},children:Object(P.jsx)(de.a,{onClick:function(){k(),i(t._id)},children:Object(P.jsx)(_e.a,{})})})]}),t.file&&Object(P.jsx)(p.a,{children:t.file.map((function(e){return Object(P.jsx)(Ee,{fileData:e,setShow:u,setChatImage:v})}))}),Object(P.jsx)("p",{className:"text-white ms-3 mt-1 last__seen",children:Z()(t.updatedAt).fromNow()})]})]}):a.email===t.from&&s.email===t.to?Object(P.jsxs)("div",{className:"d-flex flex-column justify-content-end align-items-end my-3",style:{marginLeft:"20%"},children:[Object(P.jsxs)("div",{className:"d-flex my__chat text-right justify-content-end",children:[Object(P.jsxs)("div",{className:"chat__card me-3 d-flex justify-content-center align-items-center",children:[Object(P.jsx)(_.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:N,className:"me-3",children:Object(P.jsx)(Oe.a,{})}),Object(P.jsxs)(ue.a,{id:"long-menu",anchorEl:b,keepMounted:!0,open:w,onClose:k,PaperProps:{style:{maxHeight:216}},children:[Object(P.jsx)(de.a,{onClick:function(){k(),r(t._id)},children:Object(P.jsx)(ve.a,{})}),t.message&&Object(P.jsx)(de.a,{onClick:function(){k(),c(t._id)},children:Object(P.jsx)(Ne.a,{})}),Object(P.jsx)(de.a,{onClick:function(){k(),i(t._id)},children:Object(P.jsx)(_e.a,{})})]}),t.message&&Object(P.jsxs)("div",{className:"chat__person me-3 p-2",children:[t.repliedOf&&Object(P.jsx)(je.a,{body:!0,className:"chat__person me-3 p-2 bg-dark text-white col-4 text-truncate",style:{width:"100%"},children:t.repliedOf}),Object(P.jsx)(je.a,{body:!0,className:"chat__person me-3 p-2",style:{width:"100%"},children:t.message.startsWith("http")?Object(P.jsx)(me.ReactTinyLink,{cardSize:"small",showGraphic:!0,maxLine:2,minLine:1,proxyUrl:"https://corsanywhere.herokuapp.com",url:t.message}):t.message})]}),t.file&&Object(P.jsx)(p.a,{children:t.file.map((function(e){return Object(P.jsx)(Ee,{fileData:e,setShow:u,setChatImage:v})}))})]}),Object(P.jsx)(y.a,{alt:a.name,src:a.photo})]}),Object(P.jsx)("p",{className:"text-white mt-1 pe-5 last__seen",children:Z()(t.updatedAt).fromNow()}),Object(P.jsxs)(Q.a,{show:j,onHide:function(){return u(!j)},fullscreen:"md-down",centered:!0,className:"shadow-lg w-100",children:[Object(P.jsx)("img",{alt:g,src:g}),Object(P.jsx)(le.a,{className:"bg-white rounded-circle position-absolute",style:{top:"-10px",right:"-10px",cursor:"pointer"},onClick:function(){return u(!j)}})]})]}):(s.email,t.to,null)},Fe=a(577),Re=function(e){var t=e.userInfo,a=e.messages,n=e.findRoomUser;return Object(P.jsxs)(je.a,{elevation:10,body:!0,className:t.isActive?"bg-success p-2 d-flex align-items-center mb-3":"bg-dark p-2 d-flex align-items-center mb-3",style:{cursor:"pointer"},onClick:function(){n(t.email)},children:[Object(P.jsx)(Fe.a,{badgeContent:t.isActive?a.filter((function(e){return e.from===t.email})).length:0,color:"primary",children:Object(P.jsx)(y.a,{alt:t.name,src:t.photo,className:"shadow-lg border"})}),Object(P.jsxs)("div",{className:"ps-3 ",children:[Object(P.jsx)("p",{className:"text-white my-0 fs-6 user__name_list",children:t.name}),Object(P.jsx)("p",{className:"text-white my-0 last__seen",children:t.isActive?"Online":"Active ".concat(Z()(t.updatedAt).fromNow())})]})]})},Te=function(e){var t=e.fileData,a=e.removeFile,s=Object(n.useRef)(0);return".png"===xe.a.extname(t)||".jpg"===xe.a.extname(t)||".jpeg"===xe.a.extname(t)||".gif"===xe.a.extname(t)?Object(P.jsx)(x.a,{xs:12,md:6,className:"g-2",children:Object(P.jsxs)(je.a,{elevation:5,className:"mb-0 img__card",style:{position:"relative",height:200,width:200},children:[Object(P.jsx)("img",{src:t,height:200,width:200,className:"position-absolute",alt:"upload-".concat(t),style:{right:0,top:0,bottom:0,left:0}}),Object(P.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer"},onClick:function(){return a(t)}})]})},t):".mp4"===xe.a.extname(t)||".mov"===xe.a.extname(t)||".wmv"===xe.a.extname(t)||".flv"===xe.a.extname(t)||".webm"===xe.a.extname(t)||".mkv"===xe.a.extname(t)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsxs)(je.a,{elevation:5,className:"mb-0 img__card",style:{position:"relative"},children:[Object(P.jsx)("video",{controls:!0,width:"100%",height:"400",children:Object(P.jsx)("source",{src:t,type:"video/".concat(xe.a.extname(t).split(".")[1])})}),Object(P.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer",zIndex:1},onClick:function(){return a(t)}})]})},t):".mp3"===xe.a.extname(t)||".ogg"===xe.a.extname(t)||".mpeg"===xe.a.extname(t)?Object(P.jsx)(x.a,{xs:12,className:"g-2",children:Object(P.jsxs)("div",{className:"position-relative",children:[Object(P.jsx)("audio",{controls:!0,children:Object(P.jsx)("source",{src:t,type:"audio/".concat(xe.a.extname(t).split(".")[1])})}),Object(P.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer"},onClick:function(){return a(t)}})]})},t):(console.log(s.current.offsetHeight),Object(P.jsx)(x.a,{xs:12,md:6,className:"g-2",children:Object(P.jsx)(je.a,{elevation:5,className:"mb-0 py-3 px-3 rounded position-relative",style:{backgroundColor:"#616161"},children:Object(P.jsxs)("div",{className:"d-flex justify-content-between align-items-center",style:{width:200},children:[Object(P.jsx)(De.a,{className:"text-white"}),Object(P.jsx)("span",{className:"col-4 text-truncate text-white",children:t.split("/")[2]}),Object(P.jsx)("span",{className:"text-white",children:xe.a.extname(t)}),Object(P.jsx)(L.a,{className:"position-absolute",style:{right:0,top:0,cursor:"pointer"},onClick:function(){return a(t)}})]})})},t))},Pe=function(){var e=Object(r.c)((function(e){return e.userLogin})).user,t=Object(r.b)(),a=Object(l.g)(),s=Object(n.useState)([]),c=Object(h.a)(s,2),j=c[0],w=c[1],k=Object(i.useToasts)().addToast,C=Object(n.useState)({}),S=Object(h.a)(C,2),L=S[0],U=S[1],D=Object(n.useState)([]),E=Object(h.a)(D,2),A=E[0],R=E[1],T=Object(n.useState)(""),B=Object(h.a)(T,2),W=B[0],G=B[1],H=Object(n.useState)(""),M=Object(h.a)(H,2),z=M[0],J=M[1],$=Object(n.useState)([]),X=Object(h.a)($,2),ae=X[0],se=X[1],re=Object(n.useState)(!1),oe=Object(h.a)(re,2),je=oe[0],ue=oe[1],de=Object(n.useState)(!1),me=Object(h.a)(de,2),he=me[0],be=me[1],pe=Object(n.useState)({}),xe=Object(h.a)(pe,2),fe=xe[0],Oe=xe[1],ge=Object(n.useState)(""),ve=Object(h.a)(ge,2),we=ve[0],Ne=ve[1],ye=Object(n.useRef)(0),_e=Object(n.useRef)(0),ke=new Audio("/msg_sound.mp3"),Ce=Object(n.useRef)(null);Object(n.useEffect)((function(){Ce.current=Object(ee.io)("/"),Ce.current.on("user-joined",(function(t){var a=t.allUsers.filter((function(t){return t.email!==e.email}));w(a),t.joinedUser&&t.joinedUser.email!==e.email&&(null===e||void 0===e?void 0:e.isLoggedIn)?(k("".concat(t.joinedUser.name," is active"),{appearance:"info",autoDismiss:!0}),null!==L&&L.email===t.joinedUser.email&&U(t.joinedUser)):t.leavingUser&&t.leavingUser.email!==e.email&&(null===e||void 0===e?void 0:e.isLoggedIn)&&U(t.leavingUser)})),Ce.current.on("chat-message",(function(e){ke.play(),R((function(t){return[].concat(Object(d.a)(t),[e])}))})),Ce.current.on("removeMsgFromChat",function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.a.get("/api/v1/messages");case 3:a=e.sent,n=a.data,R(n.messages),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),Ce.current.emit("user-login",e);try{(function(){var e=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.get("/api/v1/messages");case 2:t=e.sent,a=t.data,R(a.messages);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}catch(t){console.log(t)}return e||(null===e||void 0===e?void 0:e.isLoggedIn)||a.push("/"),function(){Ce.current.off("user-joined",(function(e){})),Ce.current.off("room-user-details",(function(e){})),Ce.current.off("chat-message",(function(e){})),Ce.current.off("removeMsgFromChat",(function(e){}))}}),[k,e,z]);var Se=function(e){U(j.filter((function(t){return t.email===e}))[0])},Le=function(){var t=Object(m.a)(u.a.mark((function t(a){var n,s,c,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),s={_id:we,user:e._id,from:e.email,file:ae,repliedOf:null!==(n=fe.message)&&void 0!==n?n:"",to:L.email,message:W,sendAt:Date.now()},!(W&&ae||ae||"Enter"===a.key)){t.next=22;break}return G(""),t.prev=4,t.next=7,N.a.post("/api/v1/messages",s);case 7:c=t.sent,r=c.data,R([].concat(Object(d.a)(A),[r.message])),Ce.current.emit("message",r.message),ue(!1),se([]),Oe({}),Ne(""),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(4),console.log(t.t0);case 20:t.next=23;break;case 22:k("Please Write something",{appearance:"info",autoDismiss:!0});case 23:case"end":return t.stop()}}),t,null,[[4,17]])})));return function(e){return t.apply(this,arguments)}}(),Ue=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,s,c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.target.files,n=new FormData,s=0;s<a.length;s++)n.append("uploads",a[s]);return e.prev=3,e.next=6,N.a.post("/api/v1/upload",n);case 6:c=e.sent,(r=c.data).map((function(e){return se((function(t){return[].concat(Object(d.a)(t),[e.filePath])}))})),r.length?ue(!0):ue(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.log(e.t0.response);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(m.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split("/uploads/")[1],e.next=3,N.a.delete("/api/v1/upload/".concat(a));case 3:se(ae.filter((function(e){return e!==t}))),1===ae.length?ue(!1):ue(!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),De=function(){ae.length&&(ae.map((function(e){return Ie(e)})),ae.length-1>0&&k("Remove ".concat(ae.length-1," files"),{autoDismiss:!0,appearance:"info"})),ae.length||ue(!je)},Ee=function(e){Ce.current.emit("messageDelete",e)},Fe=function(e){Ne(e),R(A.filter((function(t){return t._id!==e}))),G(A.filter((function(t){return t._id===e}))[0].message)},Pe=function(e){Oe(A.filter((function(t){return t._id===e}))[0])};return Object(P.jsxs)("div",{children:[Object(P.jsx)(g.a,{bg:"dark",className:"nav__bar",ref:ye,expand:"lg",children:Object(P.jsxs)(b.a,{fluid:"lg",children:[Object(P.jsx)(o.b,{to:"/",children:Object(P.jsxs)(g.a.Brand,{className:"text-white align-items-center",children:[Object(P.jsx)("img",{className:"app__logo me-2",height:"30px",src:"/logo.gif",alt:"logo"}),Object(P.jsx)("span",{className:"h4",children:"Chat-Buddy"})]})}),Object(P.jsx)(g.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(P.jsx)(g.a.Collapse,{id:"basic-navbar-nav",children:Object(P.jsxs)(v.a,{className:"ms-auto align-items-center",children:[Object(P.jsx)(v.a.Link,{className:"text-white fs-5",children:Object(P.jsx)(o.c,{to:"/",children:"Home"})}),Object(P.jsx)(v.a.Link,{className:"text-white fs-5",children:e.name}),Object(P.jsx)(v.a.Link,{className:"text-white fs-5",children:e.email}),Object(P.jsx)(v.a.Link,{className:"text-white",children:Object(P.jsxs)(_.a,{className:"fs-7",onClick:function(){t(function(){var e=Object(m.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("user"),t({type:F});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ce.current.disconnect(),a.push("/"),localStorage.removeItem("roomUser")},children:[Object(P.jsx)(ne.a,{className:"text-white"}),Object(P.jsx)("span",{className:"logout",children:"Logout"})," "]})})]})})]})}),Object(P.jsx)("section",{className:"bg__black",children:Object(P.jsx)(b.a,{fluid:"lg",children:Object(P.jsxs)(p.a,{children:[Object(P.jsxs)(x.a,{md:3,style:{height:"calc(100vh - ".concat(ye.current.offsetHeight+_e.current.offsetHeight,"px)"),backgroundColor:"#1c2834"},children:[Object(P.jsx)("div",{className:"search__bar",children:Object(P.jsxs)(Y.a,{className:"py-3",children:[Object(P.jsx)(Y.a.Text,{id:"search",className:"bg-white border-end-0",children:Object(P.jsx)(q.a,{})}),Object(P.jsx)(K.a,{className:"border-start-0",placeholder:"Username","aria-label":"Username","aria-describedby":"search",value:z,onChange:function(e){return J(e.target.value)},type:"text"})]})}),j&&j.map((function(e){return Object(P.jsx)(Re,{userInfo:e,messages:A,findRoomUser:Se},e.email)}))]}),Object(P.jsx)(x.a,{md:9,className:"bg-primary",children:Object(P.jsx)("main",{className:"position-relative h-100",children:L.email?Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("section",{className:"message__header d-flex align-items-center py-4 px-2 border-bottom",id:"user__head",children:[Object(P.jsx)(y.a,{alt:L.name,src:L.photo,style:{height:50,width:50,cursor:"pointer"},onClick:function(){return be(!0)}}),Object(P.jsxs)("div",{className:"ps-3",children:[Object(P.jsx)("h4",{className:"text-white my-0",children:L.name}),Object(P.jsx)("p",{className:"text-white my-0",children:L.isActive?"Online":"Last Seen ".concat(Z()(L.updatedAt).calendar())})]})]}),Object(P.jsx)(te.a,{className:"message__body overflow-auto position-relative",children:A&&A.map((function(t){return Object(P.jsx)(Ae,{messageDetails:t,user:e,roomUser:L,removeFile:Ie,editMsg:Fe,deleteMsg:Ee,replyMsg:Pe},t.id)}))}),Object(P.jsx)("section",{className:"input__area position-absolute bottom-0 start-0 end-0",id:"text__area",children:Object(P.jsx)("form",{onSubmit:Le,className:"mb-2",children:Object(P.jsxs)(p.a,{children:[null!==fe&&fe.message&&Object(P.jsx)(x.a,{xs:10,children:Object(P.jsx)("div",{className:"px-3 py-2",children:Object(P.jsxs)("p",{className:"mb-0 col-10 text-truncate text-white",children:[Object(P.jsx)("b",{children:"Replying to:"}),fe.message]})})}),Object(P.jsx)(x.a,{xs:10,children:Object(P.jsx)(f.a.Group,{controlId:"formBasicEmail",children:Object(P.jsx)(f.a.Control,{value:W,onChange:function(e){return G(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?Le(e):G(e.target.value)},type:"text",as:"textarea",className:"rounded text__input bg-primary text-white",autoComplete:"off"})})}),Object(P.jsx)(x.a,{xs:1,children:Object(P.jsxs)("label",{htmlFor:"icon-button-file",className:"float-end",children:[Object(P.jsx)(V.a,{id:"icon-button-file",type:"file",onChange:Ue,hidden:!0}),Object(P.jsx)(_.a,{"aria-label":"upload picture",component:"span",className:"border p-2 input__file__button",children:Object(P.jsx)(ie.a,{className:"attachments__icon text-dark"})})]})}),Object(P.jsx)(x.a,{xs:1,children:Object(P.jsx)(O.a,{variant:"outline-secondary rounded-circle p-2 pl-3 shadow-lg float-start",className:"ms-2",type:"submit",children:Object(P.jsx)(ce.a,{className:"attachments__icon"})})})]})})})]}):Object(P.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},children:Object(P.jsx)("h4",{className:"text-white",children:"Please Select a conversation"})})})})]})})}),Object(P.jsx)(g.a,{style:{background:"#000"},className:"nav__bar ",ref:_e,expand:"lg",children:Object(P.jsxs)(b.a,{fluid:"md",children:[Object(P.jsxs)(v.a,{className:"me-auto align-items-center py-3 text-white",children:["Copyright ",Object(P.jsx)(I.a,{className:"me-2"})," ",(new Date).getFullYear()," ","e-Chat-Buddy. All rights reserved."]}),Object(P.jsx)(v.a,{className:"ms-auto align-items-center py-3 text-white",children:"Designed & Developed By Sazzad Bin Anwar"})]})}),Object(P.jsxs)(Q.a,{show:je,onHide:function(){return ue(!je)},fullscreen:"md-down",centered:!0,backdrop:"static",className:"shadow-lg",children:[Object(P.jsx)(Q.a.Header,{children:Object(P.jsxs)(Q.a.Title,{className:"position-relative w-100",children:["Upload File"," ",Object(P.jsx)(_.a,{className:"position-absolute top-0 end-0",onClick:function(){return De()},children:Object(P.jsx)(le.a,{})})]})}),Object(P.jsx)(Q.a.Body,{children:Object(P.jsx)(p.a,{style:{maxHeight:450,overflowY:"auto"},children:ae&&ae.map((function(e){return Object(P.jsx)(Te,{fileData:e,removeFile:Ie},e)}))})}),Object(P.jsxs)(Q.a.Footer,{children:[Object(P.jsx)(O.a,{variant:"secondary",onClick:function(){return De()},children:"Close"}),Object(P.jsx)(O.a,{variant:"outline-primary",onClick:Le,children:Object(P.jsx)(ce.a,{className:"fs-7"})})]})]}),Object(P.jsxs)(Q.a,{show:he,onHide:function(){return be(!he)},fullscreen:"md-down",centered:!0,className:"shadow-lg w-100",children:[Object(P.jsx)("img",{alt:L.name,src:L.photo}),Object(P.jsx)(_.a,{className:"position-absolute top-0 end-0 bg-dark",onClick:function(){return be(!he)},children:Object(P.jsx)(le.a,{className:"text-white"})})]})]})},Be=function(){return console.log("hello"),Object(P.jsx)(b.a,{className:"mt-5",children:Object(P.jsx)(p.a,{children:Object(P.jsx)(x.a,{xs:12,md:3,children:Object(P.jsx)(je.a,{elevation:5,className:"mb-0 p-1 border rounded d-flex justify-content-between align-items-center",style:{backgroundColor:"#616161"},children:Object(P.jsx)(De.a,{className:"text-white"})})})})})},We=function(){return Object(P.jsxs)(l.d,{children:[Object(P.jsx)(l.b,{path:"/login",component:J}),Object(P.jsx)(l.b,{path:"/test",component:Be}),Object(P.jsx)(M,{path:"/chat",children:Object(P.jsx)(Pe,{})}),Object(P.jsx)(l.b,{path:"/not-found",component:W}),Object(P.jsx)(l.b,{exact:!0,path:"/",component:B}),Object(P.jsx)(l.a,{to:"/not-found"})]})},Ge=(a(537),a(538),a(539),function(){return Object(P.jsx)(o.a,{children:Object(P.jsx)(l.b,{path:"/",component:We})})}),He=a(118),Me=a(314),ze=a(315),Je=Object(He.combineReducers)({userLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return{loading:!0};case E:case R:return{loading:!1,user:t.payload};case T:case A:return{loading:!1,error:t.payload};case F:return{};default:return e}}}),Ye=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},Ke={userLogin:{user:Ye.isLoggedIn?Ye:{isLoggedIn:!1}}},Qe=[ze.a],$e=Object(He.createStore)(Je,Ke,Object(Me.composeWithDevTools)(He.applyMiddleware.apply(void 0,Qe))),qe=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,589)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))},Ve=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Xe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(Object(P.jsx)(r.a,{store:$e,children:Object(P.jsx)(i.ToastProvider,{children:Object(P.jsx)(Ge,{})})}),document.getElementById("root")),qe(),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Ve?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Xe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Xe(t,e)}))}}()}},[[540,1,2]]]);
//# sourceMappingURL=main.0bda180e.chunk.js.map